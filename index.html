<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wall of Death Viability Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .slider-thumb::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f97316;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .slider-thumb::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: #f97316;
      cursor: pointer;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: #e5e7eb;
      outline: none;
    }
    input[type="range"]::-webkit-slider-runnable-track {
      height: 8px;
      border-radius: 4px;
    }
    .tab-active {
      border-bottom: 3px solid #f97316;
      color: #f97316;
    }
    @keyframes pulse-green {
      0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.4); }
      50% { box-shadow: 0 0 0 8px rgba(34, 197, 94, 0); }
    }
    .pulse-green { animation: pulse-green 2s infinite; }
  </style>
</head>
<body class="bg-gray-50 min-h-screen">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;

    // ============== UTILITY FUNCTIONS ==============
    const formatCurrency = (num) => {
      return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(num);
    };

    const formatPercent = (num) => {
      return `${(num * 100).toFixed(1)}%`;
    };

    // URL State Management
    const encodeStateToURL = (state) => {
      const params = new URLSearchParams();
      Object.entries(state).forEach(([key, value]) => {
        if (typeof value === 'object') {
          params.set(key, JSON.stringify(value));
        } else {
          params.set(key, String(value));
        }
      });
      return params.toString();
    };

    const decodeStateFromURL = () => {
      const params = new URLSearchParams(window.location.search);
      const state = {};
      params.forEach((value, key) => {
        try {
          state[key] = JSON.parse(value);
        } catch {
          if (value === 'true') state[key] = true;
          else if (value === 'false') state[key] = false;
          else if (!isNaN(Number(value))) state[key] = Number(value);
          else state[key] = value;
        }
      });
      return state;
    };

    // ============== DEFAULT ASSUMPTIONS ==============
    const DEFAULT_ASSUMPTIONS = {
      // Event Volume
      annualEvents: 40,
      fairsMix: 40,
      festivalsMix: 40,
      corporateMix: 20,

      // Pricing
      fairsPrice: 9000,
      festivalsPrice: 8000,
      corporatePrice: 12000,
      privatePrice: 15000,

      // Ancillary
      ancillaryEnabled: true,
      merchPerEvent: 500,
      vipPerEvent: 600,
      streamingPerEvent: 200,
      sponsorshipPerEvent: 300,

      // Fixed Costs (Monthly)
      salaryMonthly: 3000,
      maintenanceMonthly: 1000,
      marketingMonthly: 500,
      adminMonthly: 300,

      // Variable Costs (Per Event)
      performerFee: 8000,
      travelPerEvent: 2000,
      merchCostPerEvent: 200,
      medicalPerEvent: 200,

      // Insurance Model
      insuranceModel: 'hybrid', // 'per-event', 'annual', 'hybrid'

      // Risk Factors
      weatherCancellation: 10,
      equipmentFailure: 5,
      performerInjury: 3,
      bookingMiss: 0,

      // Growth
      addSecondPerformer: false,
      geographicExpansion: false,
      ancillaryOptimization: false,

      // Equipment Reserve
      equipmentReserve: 5,
    };

    // Insurance costs
    const INSURANCE_COSTS = {
      perEvent: 171,
      annual: 326,
    };

    // ============== CALCULATION ENGINE ==============
    const calculateFinancials = (assumptions) => {
      const a = assumptions;
      
      // Normalize mix percentages
      const totalMix = a.fairsMix + a.festivalsMix + a.corporateMix;
      const fairsRatio = a.fairsMix / totalMix;
      const festivalsRatio = a.festivalsMix / totalMix;
      const corporateRatio = a.corporateMix / totalMix;
      const privateRatio = 0; // Private events come from corporate mix overflow

      // Calculate actual events after booking miss
      const actualEvents = Math.round(a.annualEvents * (1 - a.bookingMiss / 100));

      // Event breakdown by type
      const fairsEvents = Math.round(actualEvents * fairsRatio);
      const festivalsEvents = Math.round(actualEvents * festivalsRatio);
      const corporateEvents = Math.round(actualEvents * corporateRatio);

      // Base Revenue
      const fairsRevenue = fairsEvents * a.fairsPrice;
      const festivalsRevenue = festivalsEvents * a.festivalsPrice;
      const corporateRevenue = corporateEvents * a.corporatePrice;
      const baseRevenue = fairsRevenue + festivalsRevenue + corporateRevenue;

      // Ancillary Revenue
      let ancillaryRevenue = 0;
      if (a.ancillaryEnabled) {
        const ancillaryPerEvent = a.merchPerEvent + a.vipPerEvent + a.streamingPerEvent + a.sponsorshipPerEvent;
        ancillaryRevenue = actualEvents * ancillaryPerEvent;
      }

      // Weather cancellation impact (reduces revenue by 50% per cancelled event)
      const cancelledEvents = Math.round(actualEvents * (a.weatherCancellation / 100));
      const avgEventRevenue = actualEvents > 0 ? baseRevenue / actualEvents : 0;
      const cancellationLoss = cancelledEvents * avgEventRevenue * 0.5;

      // Total Revenue
      const grossRevenue = baseRevenue + ancillaryRevenue;
      const totalRevenue = grossRevenue - cancellationLoss;

      // Fixed Costs (Annual)
      const fixedCostsMonthly = a.salaryMonthly + a.maintenanceMonthly + a.marketingMonthly + a.adminMonthly;
      const fixedCostsAnnual = fixedCostsMonthly * 12;

      // Insurance Cost (based on model)
      let insuranceCost;
      if (a.insuranceModel === 'per-event') {
        insuranceCost = actualEvents * INSURANCE_COSTS.perEvent;
      } else if (a.insuranceModel === 'annual') {
        insuranceCost = INSURANCE_COSTS.annual;
      } else {
        // Hybrid: Annual base + overflow at per-event rate
        insuranceCost = INSURANCE_COSTS.annual;
        if (actualEvents > 40) {
          insuranceCost += (actualEvents - 40) * INSURANCE_COSTS.perEvent;
        }
      }

      // Variable Costs
      const variablePerEvent = a.performerFee + a.travelPerEvent + a.merchCostPerEvent + a.medicalPerEvent;
      const variableCostsTotal = actualEvents * variablePerEvent;

      // Equipment Reserve
      const equipmentReserveCost = totalRevenue * (a.equipmentReserve / 100);

      // Second Performer Costs (if enabled)
      let secondPerformerCost = 0;
      if (a.addSecondPerformer) {
        secondPerformerCost = 45000; // Annual cost for second performer
      }

      // Total Operating Costs
      const totalCosts = fixedCostsAnnual + insuranceCost + variableCostsTotal + equipmentReserveCost + secondPerformerCost;

      // Profitability
      const grossProfit = totalRevenue - totalCosts;
      const operatingMargin = totalRevenue > 0 ? grossProfit / totalRevenue : 0;

      // Breakeven Analysis
      const avgRevenuePerEvent = actualEvents > 0 ? totalRevenue / actualEvents : 10000;
      const variableCostPerEvent = variablePerEvent;
      const contributionMargin = avgRevenuePerEvent - variableCostPerEvent;
      const breakEvenEvents = contributionMargin > 0 ? Math.ceil((fixedCostsAnnual + insuranceCost + equipmentReserveCost) / contributionMargin) : 999;
      const marginOfSafety = actualEvents - breakEvenEvents;

      return {
        // Events
        actualEvents,
        fairsEvents,
        festivalsEvents,
        corporateEvents,
        cancelledEvents,

        // Revenue
        baseRevenue,
        ancillaryRevenue,
        cancellationLoss,
        grossRevenue,
        totalRevenue,

        // Costs Breakdown
        fixedCostsMonthly,
        fixedCostsAnnual,
        insuranceCost,
        variableCostsTotal,
        equipmentReserveCost,
        secondPerformerCost,
        totalCosts,

        // Profitability
        grossProfit,
        operatingMargin,

        // Breakeven
        breakEvenEvents,
        marginOfSafety,
        avgRevenuePerEvent,
      };
    };

    // ============== COMPONENTS ==============

    // Slider Component
    const Slider = ({ label, value, onChange, min, max, step = 1, unit = '', helpText }) => (
      <div className="mb-4">
        <div className="flex justify-between items-center mb-1">
          <label className="text-sm font-medium text-gray-700">{label}</label>
          <span className="text-sm font-semibold text-orange-600">
            {unit === '$' ? formatCurrency(value) : `${value}${unit}`}
          </span>
        </div>
        <input
          type="range"
          min={min}
          max={max}
          step={step}
          value={value}
          onChange={(e) => onChange(Number(e.target.value))}
          className="w-full slider-thumb cursor-pointer"
        />
        <div className="flex justify-between text-xs text-gray-400 mt-1">
          <span>{unit === '$' ? formatCurrency(min) : `${min}${unit}`}</span>
          <span>{unit === '$' ? formatCurrency(max) : `${max}${unit}`}</span>
        </div>
        {helpText && <p className="text-xs text-gray-500 mt-1">{helpText}</p>}
      </div>
    );

    // Toggle Component
    const Toggle = ({ label, value, onChange, helpText }) => (
      <div className="flex items-center justify-between py-2">
        <div>
          <span className="text-sm font-medium text-gray-700">{label}</span>
          {helpText && <p className="text-xs text-gray-500">{helpText}</p>}
        </div>
        <button
          onClick={() => onChange(!value)}
          className={`relative w-12 h-6 rounded-full transition-colors ${value ? 'bg-orange-500' : 'bg-gray-300'}`}
        >
          <span className={`absolute top-1 w-4 h-4 bg-white rounded-full transition-transform shadow ${value ? 'translate-x-7' : 'translate-x-1'}`} />
        </button>
      </div>
    );

    // Radio Group Component
    const RadioGroup = ({ label, options, value, onChange, helpText }) => (
      <div className="mb-4">
        <label className="text-sm font-medium text-gray-700 block mb-2">{label}</label>
        <div className="space-y-2">
          {options.map((option) => (
            <label key={option.value} className="flex items-start gap-3 cursor-pointer group">
              <input
                type="radio"
                name={label}
                checked={value === option.value}
                onChange={() => onChange(option.value)}
                className="mt-1 w-4 h-4 text-orange-500 border-gray-300 focus:ring-orange-500"
              />
              <div>
                <span className="text-sm font-medium text-gray-800 group-hover:text-orange-600">{option.label}</span>
                {option.description && <p className="text-xs text-gray-500">{option.description}</p>}
              </div>
            </label>
          ))}
        </div>
        {helpText && <p className="text-xs text-gray-500 mt-2 italic">{helpText}</p>}
      </div>
    );

    // Stat Card Component
    const StatCard = ({ label, value, subtext, color = 'gray', large = false }) => {
      const colorClasses = {
        green: 'bg-green-50 border-green-200 text-green-800',
        yellow: 'bg-yellow-50 border-yellow-200 text-yellow-800',
        red: 'bg-red-50 border-red-200 text-red-800',
        orange: 'bg-orange-50 border-orange-200 text-orange-800',
        gray: 'bg-gray-50 border-gray-200 text-gray-800',
      };
      
      return (
        <div className={`rounded-lg border p-4 ${colorClasses[color]}`}>
          <p className="text-xs font-medium opacity-70 uppercase tracking-wide">{label}</p>
          <p className={`font-bold ${large ? 'text-2xl' : 'text-xl'} mt-1`}>{value}</p>
          {subtext && <p className="text-xs mt-1 opacity-70">{subtext}</p>}
        </div>
      );
    };

    // Section Header Component
    const SectionHeader = ({ title, subtitle }) => (
      <div className="mb-6">
        <h2 className="text-xl font-bold text-gray-900">{title}</h2>
        {subtitle && <p className="text-sm text-gray-500 mt-1">{subtitle}</p>}
      </div>
    );

    // ============== MAIN SECTIONS ==============

    // Input Assumptions Section
    const InputAssumptions = ({ assumptions, setAssumptions }) => {
      const updateAssumption = (key, value) => {
        setAssumptions(prev => ({ ...prev, [key]: value }));
      };

      return (
        <div className="space-y-8">
          {/* Event Volume */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">üé™</span> Event Volume & Mix
            </h3>
            
            <Slider
              label="Annual Target Events"
              value={assumptions.annualEvents}
              onChange={(v) => updateAssumption('annualEvents', v)}
              min={10}
              max={100}
              helpText="Year 1 validated target: 40 events"
            />
            
            <div className="grid grid-cols-3 gap-4 mt-4">
              <Slider
                label="County Fairs"
                value={assumptions.fairsMix}
                onChange={(v) => updateAssumption('fairsMix', v)}
                min={0}
                max={100}
                unit="%"
              />
              <Slider
                label="Festivals"
                value={assumptions.festivalsMix}
                onChange={(v) => updateAssumption('festivalsMix', v)}
                min={0}
                max={100}
                unit="%"
              />
              <Slider
                label="Corporate"
                value={assumptions.corporateMix}
                onChange={(v) => updateAssumption('corporateMix', v)}
                min={0}
                max={100}
                unit="%"
              />
            </div>
          </div>

          {/* Pricing Model */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">üí∞</span> Pricing Model
            </h3>
            
            <div className="grid grid-cols-2 gap-4">
              <Slider
                label="County Fair Fee"
                value={assumptions.fairsPrice}
                onChange={(v) => updateAssumption('fairsPrice', v)}
                min={6000}
                max={12000}
                step={500}
                unit="$"
              />
              <Slider
                label="Festival Fee"
                value={assumptions.festivalsPrice}
                onChange={(v) => updateAssumption('festivalsPrice', v)}
                min={6000}
                max={10000}
                step={500}
                unit="$"
              />
              <Slider
                label="Corporate Fee"
                value={assumptions.corporatePrice}
                onChange={(v) => updateAssumption('corporatePrice', v)}
                min={10000}
                max={15000}
                step={500}
                unit="$"
              />
              <Slider
                label="Private Event Fee"
                value={assumptions.privatePrice}
                onChange={(v) => updateAssumption('privatePrice', v)}
                min={12000}
                max={20000}
                step={500}
                unit="$"
              />
            </div>
          </div>

          {/* Ancillary Revenue */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">üéÅ</span> Ancillary Revenue
            </h3>
            
            <Toggle
              label="Include Ancillary Revenue"
              value={assumptions.ancillaryEnabled}
              onChange={(v) => updateAssumption('ancillaryEnabled', v)}
              helpText="Merch, VIP, streaming, sponsorships"
            />
            
            {assumptions.ancillaryEnabled && (
              <div className="grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-100">
                <Slider
                  label="Merchandise (per event)"
                  value={assumptions.merchPerEvent}
                  onChange={(v) => updateAssumption('merchPerEvent', v)}
                  min={100}
                  max={1500}
                  step={50}
                  unit="$"
                />
                <Slider
                  label="VIP Meet & Greet (per event)"
                  value={assumptions.vipPerEvent}
                  onChange={(v) => updateAssumption('vipPerEvent', v)}
                  min={100}
                  max={1500}
                  step={50}
                  unit="$"
                />
                <Slider
                  label="Streaming Rights (per event)"
                  value={assumptions.streamingPerEvent}
                  onChange={(v) => updateAssumption('streamingPerEvent', v)}
                  min={0}
                  max={2000}
                  step={50}
                  unit="$"
                />
                <Slider
                  label="Sponsorship (per event)"
                  value={assumptions.sponsorshipPerEvent}
                  onChange={(v) => updateAssumption('sponsorshipPerEvent', v)}
                  min={0}
                  max={2000}
                  step={50}
                  unit="$"
                />
              </div>
            )}
          </div>

          {/* Insurance Model - CRITICAL */}
          <div className="bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl shadow-sm border-2 border-orange-300 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-2 flex items-center gap-2">
              <span className="text-2xl">üõ°Ô∏è</span> Insurance Model
              <span className="text-xs bg-orange-500 text-white px-2 py-0.5 rounded-full font-medium">CRITICAL</span>
            </h3>
            <p className="text-sm text-orange-800 mb-4">
              This decision impacts costs by <strong>$6,500+/year</strong>
            </p>
            
            <RadioGroup
              label=""
              value={assumptions.insuranceModel}
              onChange={(v) => updateAssumption('insuranceModel', v)}
              options={[
                {
                  value: 'per-event',
                  label: `Per-Event Policy ($${INSURANCE_COSTS.perEvent}/event)`,
                  description: `40 events = ${formatCurrency(40 * INSURANCE_COSTS.perEvent)}/year. Best if booking unpredictable.`,
                },
                {
                  value: 'annual',
                  label: `Annual Policy (${formatCurrency(INSURANCE_COSTS.annual)}/year flat)`,
                  description: 'Best if 30+ events planned. Saves $6,500+ vs per-event.',
                },
                {
                  value: 'hybrid',
                  label: `Hybrid (Annual base + per-event overflow)`,
                  description: `${formatCurrency(INSURANCE_COSTS.annual)} base, then $${INSURANCE_COSTS.perEvent}/event after 40. Good for uncertain trajectory.`,
                },
              ]}
            />
          </div>

          {/* Operating Costs */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">üìä</span> Operating Costs
            </h3>
            
            <h4 className="text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide">Fixed Costs (Monthly)</h4>
            <div className="grid grid-cols-2 gap-4 mb-6">
              <Slider
                label="Salary/Coordinator"
                value={assumptions.salaryMonthly}
                onChange={(v) => updateAssumption('salaryMonthly', v)}
                min={2000}
                max={5000}
                step={250}
                unit="$"
              />
              <Slider
                label="Equipment Maintenance"
                value={assumptions.maintenanceMonthly}
                onChange={(v) => updateAssumption('maintenanceMonthly', v)}
                min={500}
                max={1500}
                step={100}
                unit="$"
              />
              <Slider
                label="Marketing/Website"
                value={assumptions.marketingMonthly}
                onChange={(v) => updateAssumption('marketingMonthly', v)}
                min={300}
                max={1000}
                step={50}
                unit="$"
              />
              <Slider
                label="Office/Admin"
                value={assumptions.adminMonthly}
                onChange={(v) => updateAssumption('adminMonthly', v)}
                min={200}
                max={500}
                step={50}
                unit="$"
              />
            </div>

            <h4 className="text-sm font-semibold text-gray-600 mb-3 uppercase tracking-wide">Variable Costs (Per Event)</h4>
            <div className="grid grid-cols-2 gap-4">
              <Slider
                label="Performer Fee"
                value={assumptions.performerFee}
                onChange={(v) => updateAssumption('performerFee', v)}
                min={6000}
                max={12000}
                step={500}
                unit="$"
              />
              <Slider
                label="Travel/Transport"
                value={assumptions.travelPerEvent}
                onChange={(v) => updateAssumption('travelPerEvent', v)}
                min={0}
                max={5000}
                step={250}
                unit="$"
              />
              <Slider
                label="Merch Production"
                value={assumptions.merchCostPerEvent}
                onChange={(v) => updateAssumption('merchCostPerEvent', v)}
                min={100}
                max={500}
                step={25}
                unit="$"
              />
              <Slider
                label="Medical/Emergency"
                value={assumptions.medicalPerEvent}
                onChange={(v) => updateAssumption('medicalPerEvent', v)}
                min={100}
                max={500}
                step={25}
                unit="$"
              />
            </div>

            <div className="mt-4 pt-4 border-t border-gray-100">
              <Slider
                label="Equipment Replacement Reserve"
                value={assumptions.equipmentReserve}
                onChange={(v) => updateAssumption('equipmentReserve', v)}
                min={0}
                max={15}
                unit="%"
                helpText="% of revenue set aside for unexpected repairs"
              />
            </div>
          </div>

          {/* Risk Factors */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">‚ö†Ô∏è</span> Risk & Cancellation Factors
            </h3>
            
            <div className="grid grid-cols-2 gap-4">
              <Slider
                label="Weather Cancellation Rate"
                value={assumptions.weatherCancellation}
                onChange={(v) => updateAssumption('weatherCancellation', v)}
                min={0}
                max={30}
                unit="%"
                helpText="Each cancellation = 50% performer fee loss"
              />
              <Slider
                label="Equipment Failure Rate"
                value={assumptions.equipmentFailure}
                onChange={(v) => updateAssumption('equipmentFailure', v)}
                min={0}
                max={15}
                unit="%"
              />
              <Slider
                label="Performer Injury Rate"
                value={assumptions.performerInjury}
                onChange={(v) => updateAssumption('performerInjury', v)}
                min={0}
                max={10}
                unit="%"
              />
              <Slider
                label="Lower-Than-Expected Bookings"
                value={assumptions.bookingMiss}
                onChange={(v) => updateAssumption('bookingMiss', v)}
                min={0}
                max={50}
                unit="%"
                helpText="Reduces total events from target"
              />
            </div>
          </div>

          {/* Growth Assumptions */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
              <span className="text-2xl">üìà</span> Growth Assumptions (Year 2+)
            </h3>
            
            <Toggle
              label="Add Second Performer"
              value={assumptions.addSecondPerformer}
              onChange={(v) => updateAssumption('addSecondPerformer', v)}
              helpText="Event capacity 60-80 vs 40. Adds ~$45K annual cost."
            />
            <Toggle
              label="Geographic Expansion"
              value={assumptions.geographicExpansion}
              onChange={(v) => updateAssumption('geographicExpansion', v)}
              helpText="Travel costs +15-30%, booking pipeline increases"
            />
            <Toggle
              label="Ancillary Optimization (Year 3+)"
              value={assumptions.ancillaryOptimization}
              onChange={(v) => updateAssumption('ancillaryOptimization', v)}
              helpText="Ancillary revenue +20-40% per event"
            />
          </div>
        </div>
      );
    };

    // Financial Dashboard Section
    const FinancialDashboard = ({ outputs, assumptions }) => {
      const getMarginColor = (margin) => {
        if (margin >= 0.6) return 'green';
        if (margin >= 0.5) return 'yellow';
        return 'red';
      };

      const getProfitColor = (profit) => {
        if (profit > 200000) return 'green';
        if (profit > 0) return 'yellow';
        return 'red';
      };

      return (
        <div className="space-y-6">
          {/* Key Metrics */}
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            <StatCard
              label="Total Revenue"
              value={formatCurrency(outputs.totalRevenue)}
              subtext={`${outputs.actualEvents} events`}
              color="gray"
              large
            />
            <StatCard
              label="Total Costs"
              value={formatCurrency(outputs.totalCosts)}
              color="gray"
              large
            />
            <StatCard
              label="Net Profit"
              value={formatCurrency(outputs.grossProfit)}
              subtext={outputs.grossProfit > 0 ? 'Profitable' : 'Loss'}
              color={getProfitColor(outputs.grossProfit)}
              large
            />
            <StatCard
              label="Operating Margin"
              value={formatPercent(outputs.operatingMargin)}
              subtext={outputs.operatingMargin >= 0.6 ? 'Strong' : outputs.operatingMargin >= 0.5 ? 'Marginal' : 'Weak'}
              color={getMarginColor(outputs.operatingMargin)}
              large
            />
          </div>

          {/* Revenue Breakdown */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4">Revenue Breakdown</h3>
            
            <div className="space-y-3">
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Base Performance Fees</span>
                <span className="font-semibold">{formatCurrency(outputs.baseRevenue)}</span>
              </div>
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Ancillary Revenue</span>
                <span className="font-semibold text-green-600">+{formatCurrency(outputs.ancillaryRevenue)}</span>
              </div>
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Weather Cancellations ({outputs.cancelledEvents} events)</span>
                <span className="font-semibold text-red-600">-{formatCurrency(outputs.cancellationLoss)}</span>
              </div>
              <div className="flex justify-between items-center py-2 bg-gray-50 px-3 rounded-lg">
                <span className="font-semibold text-gray-900">Total Revenue (Actual)</span>
                <span className="font-bold text-xl">{formatCurrency(outputs.totalRevenue)}</span>
              </div>
            </div>

            <div className="mt-4 grid grid-cols-3 gap-3 text-center">
              <div className="bg-orange-50 rounded-lg p-3">
                <p className="text-xs text-orange-700 font-medium">County Fairs</p>
                <p className="text-lg font-bold text-orange-800">{outputs.fairsEvents}</p>
                <p className="text-xs text-orange-600">events</p>
              </div>
              <div className="bg-blue-50 rounded-lg p-3">
                <p className="text-xs text-blue-700 font-medium">Festivals</p>
                <p className="text-lg font-bold text-blue-800">{outputs.festivalsEvents}</p>
                <p className="text-xs text-blue-600">events</p>
              </div>
              <div className="bg-purple-50 rounded-lg p-3">
                <p className="text-xs text-purple-700 font-medium">Corporate</p>
                <p className="text-lg font-bold text-purple-800">{outputs.corporateEvents}</p>
                <p className="text-xs text-purple-600">events</p>
              </div>
            </div>
          </div>

          {/* Cost Breakdown */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4">Cost Breakdown</h3>
            
            <div className="space-y-3">
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Fixed Costs (Annual)</span>
                <span className="font-semibold">{formatCurrency(outputs.fixedCostsAnnual)}</span>
              </div>
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <div>
                  <span className="text-gray-600">Insurance ({assumptions.insuranceModel})</span>
                  {assumptions.insuranceModel === 'per-event' && (
                    <span className="ml-2 text-xs text-orange-600 bg-orange-100 px-2 py-0.5 rounded">‚ö†Ô∏è Higher cost model</span>
                  )}
                </div>
                <span className="font-semibold">{formatCurrency(outputs.insuranceCost)}</span>
              </div>
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Variable Costs ({outputs.actualEvents} events)</span>
                <span className="font-semibold">{formatCurrency(outputs.variableCostsTotal)}</span>
              </div>
              <div className="flex justify-between items-center py-2 border-b border-gray-100">
                <span className="text-gray-600">Equipment Reserve ({assumptions.equipmentReserve}%)</span>
                <span className="font-semibold">{formatCurrency(outputs.equipmentReserveCost)}</span>
              </div>
              {assumptions.addSecondPerformer && (
                <div className="flex justify-between items-center py-2 border-b border-gray-100">
                  <span className="text-gray-600">Second Performer</span>
                  <span className="font-semibold">{formatCurrency(outputs.secondPerformerCost)}</span>
                </div>
              )}
              <div className="flex justify-between items-center py-2 bg-gray-50 px-3 rounded-lg">
                <span className="font-semibold text-gray-900">Total Operating Costs</span>
                <span className="font-bold text-xl">{formatCurrency(outputs.totalCosts)}</span>
              </div>
            </div>
          </div>

          {/* Breakeven Analysis */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4">Breakeven Analysis</h3>
            
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
              <StatCard
                label="Breakeven Events"
                value={outputs.breakEvenEvents}
                subtext="events required"
                color={outputs.breakEvenEvents <= 30 ? 'green' : 'yellow'}
              />
              <StatCard
                label="Margin of Safety"
                value={`${outputs.marginOfSafety > 0 ? '+' : ''}${outputs.marginOfSafety}`}
                subtext="events above breakeven"
                color={outputs.marginOfSafety > 10 ? 'green' : outputs.marginOfSafety > 0 ? 'yellow' : 'red'}
              />
              <StatCard
                label="Avg Revenue/Event"
                value={formatCurrency(outputs.avgRevenuePerEvent)}
                color="gray"
              />
              <StatCard
                label="Target Met?"
                value={outputs.actualEvents >= assumptions.annualEvents ? '‚úÖ YES' : '‚ö†Ô∏è NO'}
                subtext={`${outputs.actualEvents} of ${assumptions.annualEvents}`}
                color={outputs.actualEvents >= assumptions.annualEvents ? 'green' : 'yellow'}
              />
            </div>

            {/* Visual Breakeven Bar */}
            <div className="mt-6">
              <div className="flex justify-between text-sm text-gray-600 mb-2">
                <span>0 events</span>
                <span>Breakeven: {outputs.breakEvenEvents}</span>
                <span>Target: {assumptions.annualEvents}</span>
              </div>
              <div className="h-8 bg-gray-200 rounded-full overflow-hidden relative">
                <div
                  className="h-full bg-gradient-to-r from-red-400 via-yellow-400 to-green-400"
                  style={{ width: `${Math.min(100, (outputs.actualEvents / Math.max(outputs.breakEvenEvents, assumptions.annualEvents)) * 100)}%` }}
                />
                <div
                  className="absolute top-0 h-full w-0.5 bg-gray-800"
                  style={{ left: `${Math.min(100, (outputs.breakEvenEvents / Math.max(outputs.breakEvenEvents, assumptions.annualEvents)) * 100)}%` }}
                />
              </div>
              <div className="flex justify-between text-xs text-gray-500 mt-1">
                <span>Loss Zone</span>
                <span>‚Üë Breakeven</span>
                <span>Profit Zone</span>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // Sensitivity Analysis Section
    const SensitivityAnalysis = ({ assumptions, calculateFinancials }) => {
      const scenarios = useMemo(() => {
        const base = calculateFinancials(assumptions);
        
        return [
          {
            name: 'Events Drop 25%',
            description: 'What if bookings are 25% lower than planned?',
            modified: { ...assumptions, bookingMiss: 25 },
            impact: 'Revenue impact',
          },
          {
            name: 'Insurance 2x (Per-Event)',
            description: 'Forced to use per-event insurance model',
            modified: { ...assumptions, insuranceModel: 'per-event' },
            impact: 'Cost impact',
          },
          {
            name: 'Performer Fees +10%',
            description: 'Backup performer costs increase',
            modified: { ...assumptions, performerFee: Math.round(assumptions.performerFee * 1.1) },
            impact: 'Margin impact',
          },
          {
            name: 'Weather Cancellations 20%',
            description: 'Double the cancellation rate',
            modified: { ...assumptions, weatherCancellation: 20 },
            impact: 'Revenue impact',
          },
          {
            name: 'Ancillary Underperforms -30%',
            description: 'Merch, VIP, streaming all underperform',
            modified: {
              ...assumptions,
              merchPerEvent: Math.round(assumptions.merchPerEvent * 0.7),
              vipPerEvent: Math.round(assumptions.vipPerEvent * 0.7),
              streamingPerEvent: Math.round(assumptions.streamingPerEvent * 0.7),
              sponsorshipPerEvent: Math.round(assumptions.sponsorshipPerEvent * 0.7),
            },
            impact: 'Revenue impact',
          },
        ];
      }, [assumptions]);

      const baseOutputs = calculateFinancials(assumptions);

      return (
        <div className="space-y-6">
          <div className="bg-amber-50 border border-amber-200 rounded-xl p-4 mb-6">
            <p className="text-amber-800 text-sm">
              <strong>Sensitivity Analysis</strong> shows which assumptions are "fragile" (model breaks if wrong) vs "robust" (model survives).
            </p>
          </div>

          <div className="overflow-x-auto">
            <table className="w-full bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase tracking-wide">Scenario</th>
                  <th className="px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wide">Revenue</th>
                  <th className="px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wide">Costs</th>
                  <th className="px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wide">Profit</th>
                  <th className="px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase tracking-wide">Margin</th>
                  <th className="px-4 py-3 text-center text-xs font-semibold text-gray-600 uppercase tracking-wide">Status</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-100">
                {/* Base Case */}
                <tr className="bg-orange-50">
                  <td className="px-4 py-3">
                    <p className="font-semibold text-gray-900">üìç Current Plan</p>
                    <p className="text-xs text-gray-500">Your selected assumptions</p>
                  </td>
                  <td className="px-4 py-3 text-right font-semibold">{formatCurrency(baseOutputs.totalRevenue)}</td>
                  <td className="px-4 py-3 text-right">{formatCurrency(baseOutputs.totalCosts)}</td>
                  <td className="px-4 py-3 text-right font-semibold text-green-600">{formatCurrency(baseOutputs.grossProfit)}</td>
                  <td className="px-4 py-3 text-right">{formatPercent(baseOutputs.operatingMargin)}</td>
                  <td className="px-4 py-3 text-center">
                    <span className="text-green-600 text-lg">‚úÖ</span>
                  </td>
                </tr>

                {/* Scenarios */}
                {scenarios.map((scenario, idx) => {
                  const outputs = calculateFinancials(scenario.modified);
                  const profitDiff = outputs.grossProfit - baseOutputs.grossProfit;
                  const stillProfitable = outputs.grossProfit > 0;
                  
                  return (
                    <tr key={idx} className="hover:bg-gray-50">
                      <td className="px-4 py-3">
                        <p className="font-medium text-gray-900">{scenario.name}</p>
                        <p className="text-xs text-gray-500">{scenario.description}</p>
                      </td>
                      <td className="px-4 py-3 text-right">
                        <span>{formatCurrency(outputs.totalRevenue)}</span>
                        {outputs.totalRevenue < baseOutputs.totalRevenue && (
                          <span className="block text-xs text-red-500">
                            {formatCurrency(outputs.totalRevenue - baseOutputs.totalRevenue)}
                          </span>
                        )}
                      </td>
                      <td className="px-4 py-3 text-right">
                        <span>{formatCurrency(outputs.totalCosts)}</span>
                        {outputs.totalCosts > baseOutputs.totalCosts && (
                          <span className="block text-xs text-red-500">
                            +{formatCurrency(outputs.totalCosts - baseOutputs.totalCosts)}
                          </span>
                        )}
                      </td>
                      <td className={`px-4 py-3 text-right font-semibold ${stillProfitable ? 'text-green-600' : 'text-red-600'}`}>
                        {formatCurrency(outputs.grossProfit)}
                        <span className={`block text-xs ${profitDiff >= 0 ? 'text-green-500' : 'text-red-500'}`}>
                          {profitDiff >= 0 ? '+' : ''}{formatCurrency(profitDiff)}
                        </span>
                      </td>
                      <td className="px-4 py-3 text-right">{formatPercent(outputs.operatingMargin)}</td>
                      <td className="px-4 py-3 text-center">
                        {stillProfitable ? (
                          outputs.operatingMargin >= 0.5 ? (
                            <span className="text-green-600 text-lg">‚úÖ</span>
                          ) : (
                            <span className="text-yellow-600 text-lg">‚ö†Ô∏è</span>
                          )
                        ) : (
                          <span className="text-red-600 text-lg">‚ùå</span>
                        )}
                      </td>
                    </tr>
                  );
                })}
              </tbody>
            </table>
          </div>

          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h4 className="font-semibold text-gray-900 mb-3">Key Insights</h4>
            <ul className="space-y-2 text-sm text-gray-700">
              <li className="flex items-start gap-2">
                <span className="text-green-500 mt-0.5">‚úì</span>
                <span><strong>Most robust:</strong> Model survives even with 25% booking miss and 20% weather cancellations</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-orange-500 mt-0.5">!</span>
                <span><strong>Insurance decision:</strong> Annual policy saves {formatCurrency((assumptions.annualEvents * INSURANCE_COSTS.perEvent) - INSURANCE_COSTS.annual)} vs per-event at {assumptions.annualEvents} events</span>
              </li>
              <li className="flex items-start gap-2">
                <span className="text-blue-500 mt-0.5">‚Üí</span>
                <span><strong>Breakeven cushion:</strong> {baseOutputs.marginOfSafety} events above breakeven provides safety margin</span>
              </li>
            </ul>
          </div>
        </div>
      );
    };

    // Scenario Builder Section
    const ScenarioBuilder = ({ assumptions, setAssumptions, calculateFinancials }) => {
      const PRESETS = {
        conservative: {
          name: 'Conservative',
          emoji: 'üîí',
          description: '"I want proof this works"',
          color: 'blue',
          values: {
            annualEvents: 25,
            weatherCancellation: 15,
            insuranceModel: 'per-event',
            fairsPrice: 8000,
            festivalsPrice: 7000,
            corporatePrice: 10000,
            merchPerEvent: 400,
            vipPerEvent: 480,
            streamingPerEvent: 160,
            sponsorshipPerEvent: 240,
          },
        },
        realistic: {
          name: 'Realistic',
          emoji: 'üìä',
          description: '"This is my best guess"',
          color: 'orange',
          values: {
            annualEvents: 40,
            weatherCancellation: 10,
            insuranceModel: 'hybrid',
            fairsPrice: 9000,
            festivalsPrice: 8000,
            corporatePrice: 12000,
            merchPerEvent: 500,
            vipPerEvent: 600,
            streamingPerEvent: 200,
            sponsorshipPerEvent: 300,
          },
        },
        optimistic: {
          name: 'Optimistic',
          emoji: 'üöÄ',
          description: '"If everything goes right"',
          color: 'green',
          values: {
            annualEvents: 50,
            weatherCancellation: 5,
            insuranceModel: 'annual',
            fairsPrice: 10000,
            festivalsPrice: 9000,
            corporatePrice: 13000,
            merchPerEvent: 600,
            vipPerEvent: 720,
            streamingPerEvent: 300,
            sponsorshipPerEvent: 400,
          },
        },
        worstCase: {
          name: 'Worst Case',
          emoji: 'üíÄ',
          description: '"When something breaks"',
          color: 'red',
          values: {
            annualEvents: 20,
            weatherCancellation: 25,
            insuranceModel: 'per-event',
            fairsPrice: 8000,
            festivalsPrice: 6500,
            corporatePrice: 10000,
            bookingMiss: 0,
            merchPerEvent: 300,
            vipPerEvent: 360,
            streamingPerEvent: 100,
            sponsorshipPerEvent: 150,
          },
        },
      };

      const applyPreset = (presetKey) => {
        const preset = PRESETS[presetKey];
        setAssumptions(prev => ({ ...prev, ...preset.values }));
      };

      const presetOutputs = useMemo(() => {
        return Object.entries(PRESETS).reduce((acc, [key, preset]) => {
          acc[key] = calculateFinancials({ ...DEFAULT_ASSUMPTIONS, ...preset.values });
          return acc;
        }, {});
      }, []);

      const currentOutputs = calculateFinancials(assumptions);

      const colorClasses = {
        blue: 'border-blue-300 bg-blue-50 hover:border-blue-400',
        orange: 'border-orange-300 bg-orange-50 hover:border-orange-400',
        green: 'border-green-300 bg-green-50 hover:border-green-400',
        red: 'border-red-300 bg-red-50 hover:border-red-400',
      };

      return (
        <div className="space-y-6">
          {/* Preset Buttons */}
          <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
            {Object.entries(PRESETS).map(([key, preset]) => {
              const outputs = presetOutputs[key];
              return (
                <button
                  key={key}
                  onClick={() => applyPreset(key)}
                  className={`p-4 rounded-xl border-2 transition-all text-left ${colorClasses[preset.color]}`}
                >
                  <div className="text-2xl mb-2">{preset.emoji}</div>
                  <h4 className="font-semibold text-gray-900">{preset.name}</h4>
                  <p className="text-xs text-gray-600 mb-3">{preset.description}</p>
                  <div className="space-y-1 text-xs">
                    <p><span className="text-gray-500">Events:</span> <strong>{preset.values.annualEvents}</strong></p>
                    <p><span className="text-gray-500">Profit:</span> <strong className={outputs.grossProfit > 0 ? 'text-green-600' : 'text-red-600'}>{formatCurrency(outputs.grossProfit)}</strong></p>
                    <p><span className="text-gray-500">Margin:</span> <strong>{formatPercent(outputs.operatingMargin)}</strong></p>
                  </div>
                </button>
              );
            })}
          </div>

          {/* Comparison Table */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
            <div className="p-4 border-b border-gray-200 bg-gray-50">
              <h3 className="font-semibold text-gray-900">Scenario Comparison (Year 1)</h3>
            </div>
            <div className="overflow-x-auto">
              <table className="w-full">
                <thead className="bg-gray-50">
                  <tr>
                    <th className="px-4 py-3 text-left text-xs font-semibold text-gray-600 uppercase">Metric</th>
                    {Object.entries(PRESETS).map(([key, preset]) => (
                      <th key={key} className="px-4 py-3 text-right text-xs font-semibold text-gray-600 uppercase">
                        {preset.emoji} {preset.name}
                      </th>
                    ))}
                    <th className="px-4 py-3 text-right text-xs font-semibold text-orange-600 uppercase bg-orange-50">üìç Current</th>
                  </tr>
                </thead>
                <tbody className="divide-y divide-gray-100">
                  <tr>
                    <td className="px-4 py-3 font-medium text-gray-900">Events</td>
                    {Object.entries(PRESETS).map(([key, preset]) => (
                      <td key={key} className="px-4 py-3 text-right">{preset.values.annualEvents}</td>
                    ))}
                    <td className="px-4 py-3 text-right font-semibold bg-orange-50">{assumptions.annualEvents}</td>
                  </tr>
                  <tr>
                    <td className="px-4 py-3 font-medium text-gray-900">Revenue</td>
                    {Object.entries(PRESETS).map(([key]) => (
                      <td key={key} className="px-4 py-3 text-right">{formatCurrency(presetOutputs[key].totalRevenue)}</td>
                    ))}
                    <td className="px-4 py-3 text-right font-semibold bg-orange-50">{formatCurrency(currentOutputs.totalRevenue)}</td>
                  </tr>
                  <tr>
                    <td className="px-4 py-3 font-medium text-gray-900">Costs</td>
                    {Object.entries(PRESETS).map(([key]) => (
                      <td key={key} className="px-4 py-3 text-right">{formatCurrency(presetOutputs[key].totalCosts)}</td>
                    ))}
                    <td className="px-4 py-3 text-right font-semibold bg-orange-50">{formatCurrency(currentOutputs.totalCosts)}</td>
                  </tr>
                  <tr>
                    <td className="px-4 py-3 font-medium text-gray-900">Profit</td>
                    {Object.entries(PRESETS).map(([key]) => {
                      const profit = presetOutputs[key].grossProfit;
                      return (
                        <td key={key} className={`px-4 py-3 text-right font-semibold ${profit > 0 ? 'text-green-600' : 'text-red-600'}`}>
                          {formatCurrency(profit)}
                        </td>
                      );
                    })}
                    <td className={`px-4 py-3 text-right font-bold bg-orange-50 ${currentOutputs.grossProfit > 0 ? 'text-green-600' : 'text-red-600'}`}>
                      {formatCurrency(currentOutputs.grossProfit)}
                    </td>
                  </tr>
                  <tr>
                    <td className="px-4 py-3 font-medium text-gray-900">Margin</td>
                    {Object.entries(PRESETS).map(([key]) => (
                      <td key={key} className="px-4 py-3 text-right">{formatPercent(presetOutputs[key].operatingMargin)}</td>
                    ))}
                    <td className="px-4 py-3 text-right font-semibold bg-orange-50">{formatPercent(currentOutputs.operatingMargin)}</td>
                  </tr>
                  <tr className="bg-gray-50">
                    <td className="px-4 py-3 font-medium text-gray-900">Status</td>
                    {Object.entries(PRESETS).map(([key]) => {
                      const outputs = presetOutputs[key];
                      let status, color;
                      if (outputs.grossProfit <= 0) {
                        status = '‚ùå Loss'; color = 'text-red-600';
                      } else if (outputs.operatingMargin >= 0.6) {
                        status = '‚úÖ Strong'; color = 'text-green-600';
                      } else if (outputs.operatingMargin >= 0.5) {
                        status = '‚ö†Ô∏è Marginal'; color = 'text-yellow-600';
                      } else {
                        status = '‚ö†Ô∏è Risky'; color = 'text-yellow-600';
                      }
                      return <td key={key} className={`px-4 py-3 text-right font-semibold ${color}`}>{status}</td>;
                    })}
                    <td className={`px-4 py-3 text-right font-bold bg-orange-50 ${
                      currentOutputs.grossProfit <= 0 ? 'text-red-600' :
                      currentOutputs.operatingMargin >= 0.6 ? 'text-green-600' : 'text-yellow-600'
                    }`}>
                      {currentOutputs.grossProfit <= 0 ? '‚ùå Loss' :
                       currentOutputs.operatingMargin >= 0.6 ? '‚úÖ Strong' :
                       currentOutputs.operatingMargin >= 0.5 ? '‚ö†Ô∏è Marginal' : '‚ö†Ô∏è Risky'}
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      );
    };

    // Validation Checklist Section
    const ValidationChecklist = () => {
      const [checklist, setChecklist] = useState({
        // County Fair
        calledFairDirectors: false,
        confirmedBookingWindow: false,
        verifiedAudienceSizes: false,
        askedPerformerPricing: false,
        fairNotes: '',

        // Insurance & Legal
        gotInsuranceQuote: false,
        confirmedInsuranceCosts: false,
        reviewedWaiver: false,
        confirmedLLC: false,
        insuranceNotes: '',

        // Equipment & Safety
        barrelInspected: false,
        pricedMotorcycles: false,
        medicalClearance: false,
        reviewedSafetyProtocols: false,
        equipmentNotes: '',

        // Performer
        identifiedBackup: false,
        confirmedTraining: false,
        secondPerformerInsurance: false,
        performerNotes: '',

        // Market
        talkedToPerformers: false,
        researchedCompetitors: false,
        interviewedVenues: false,
        marketNotes: '',
      });

      const toggleCheck = (key) => {
        setChecklist(prev => ({ ...prev, [key]: !prev[key] }));
      };

      const updateNote = (key, value) => {
        setChecklist(prev => ({ ...prev, [key]: value }));
      };

      const CheckItem = ({ label, checked, onToggle }) => (
        <label className="flex items-start gap-3 cursor-pointer py-2">
          <input
            type="checkbox"
            checked={checked}
            onChange={onToggle}
            className="mt-0.5 w-5 h-5 rounded border-gray-300 text-orange-500 focus:ring-orange-500"
          />
          <span className={`text-sm ${checked ? 'text-gray-500 line-through' : 'text-gray-700'}`}>{label}</span>
        </label>
      );

      const totalChecks = 17;
      const completedChecks = Object.values(checklist).filter(v => v === true).length;
      const completionPercent = Math.round((completedChecks / totalChecks) * 100);

      let overallStatus, statusColor;
      if (completionPercent >= 80) {
        overallStatus = 'Ready to Proceed';
        statusColor = 'green';
      } else if (completionPercent >= 50) {
        overallStatus = 'Partially Validated';
        statusColor = 'yellow';
      } else {
        overallStatus = 'Needs More Research';
        statusColor = 'red';
      }

      return (
        <div className="space-y-6">
          {/* Progress Header */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
            <h3 className="text-lg font-semibold text-gray-900 mb-4">Assumption Validation Progress</h3>
            <div className="flex items-center gap-4 mb-4">
              <div className="flex-1 h-4 bg-gray-200 rounded-full overflow-hidden">
                <div
                  className={`h-full transition-all ${
                    completionPercent >= 80 ? 'bg-green-500' :
                    completionPercent >= 50 ? 'bg-yellow-500' : 'bg-red-500'
                  }`}
                  style={{ width: `${completionPercent}%` }}
                />
              </div>
              <span className="text-lg font-bold text-gray-900">{completionPercent}%</span>
            </div>
            <div className={`inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium ${
              statusColor === 'green' ? 'bg-green-100 text-green-800' :
              statusColor === 'yellow' ? 'bg-yellow-100 text-yellow-800' :
              'bg-red-100 text-red-800'
            }`}>
              {statusColor === 'green' ? '‚úÖ' : statusColor === 'yellow' ? '‚ö†Ô∏è' : '‚ùå'} {overallStatus}
            </div>
          </div>

          {/* Checklist Sections */}
          <div className="grid md:grid-cols-2 gap-6">
            {/* County Fair Booking */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <span className="text-xl">üé™</span> County Fair Booking
              </h4>
              <div className="space-y-1">
                <CheckItem label="Called 5+ fair directors? (Document dates/names)" checked={checklist.calledFairDirectors} onToggle={() => toggleCheck('calledFairDirectors')} />
                <CheckItem label="Confirmed 6-12 month booking window?" checked={checklist.confirmedBookingWindow} onToggle={() => toggleCheck('confirmedBookingWindow')} />
                <CheckItem label="Verified typical audience sizes (5-20K)?" checked={checklist.verifiedAudienceSizes} onToggle={() => toggleCheck('verifiedAudienceSizes')} />
                <CheckItem label="Asked about performer pricing ($8-12K realistic)?" checked={checklist.askedPerformerPricing} onToggle={() => toggleCheck('askedPerformerPricing')} />
              </div>
              <textarea
                placeholder="Notes..."
                value={checklist.fairNotes}
                onChange={(e) => updateNote('fairNotes', e.target.value)}
                className="mt-3 w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                rows={2}
              />
            </div>

            {/* Insurance & Legal */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <span className="text-xl">üõ°Ô∏è</span> Insurance & Legal
              </h4>
              <div className="space-y-1">
                <CheckItem label="Got quote from Specialty Insurance / SADLER's?" checked={checklist.gotInsuranceQuote} onToggle={() => toggleCheck('gotInsuranceQuote')} />
                <CheckItem label="Confirmed per-event vs annual cost difference?" checked={checklist.confirmedInsuranceCosts} onToggle={() => toggleCheck('confirmedInsuranceCosts')} />
                <CheckItem label="Reviewed waiver with attorney?" checked={checklist.reviewedWaiver} onToggle={() => toggleCheck('reviewedWaiver')} />
                <CheckItem label="Confirmed LLC liability protection?" checked={checklist.confirmedLLC} onToggle={() => toggleCheck('confirmedLLC')} />
              </div>
              <textarea
                placeholder="Notes..."
                value={checklist.insuranceNotes}
                onChange={(e) => updateNote('insuranceNotes', e.target.value)}
                className="mt-3 w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                rows={2}
              />
            </div>

            {/* Equipment & Safety */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <span className="text-xl">üîß</span> Equipment & Safety
              </h4>
              <div className="space-y-1">
                <CheckItem label="Had barrel inspected by engineer?" checked={checklist.barrelInspected} onToggle={() => toggleCheck('barrelInspected')} />
                <CheckItem label="Priced spare motorcycles ($5-15K each)?" checked={checklist.pricedMotorcycles} onToggle={() => toggleCheck('pricedMotorcycles')} />
                <CheckItem label="Got medical clearance for performer?" checked={checklist.medicalClearance} onToggle={() => toggleCheck('medicalClearance')} />
                <CheckItem label="Reviewed safety protocols with insurance broker?" checked={checklist.reviewedSafetyProtocols} onToggle={() => toggleCheck('reviewedSafetyProtocols')} />
              </div>
              <textarea
                placeholder="Notes..."
                value={checklist.equipmentNotes}
                onChange={(e) => updateNote('equipmentNotes', e.target.value)}
                className="mt-3 w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                rows={2}
              />
            </div>

            {/* Performer Recruitment */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <span className="text-xl">üèçÔ∏è</span> Performer Recruitment
              </h4>
              <div className="space-y-1">
                <CheckItem label="Identified qualified backup performer?" checked={checklist.identifiedBackup} onToggle={() => toggleCheck('identifiedBackup')} />
                <CheckItem label="Confirmed training timeline (12 weeks)?" checked={checklist.confirmedTraining} onToggle={() => toggleCheck('confirmedTraining')} />
                <CheckItem label="Got insurance cost for second performer?" checked={checklist.secondPerformerInsurance} onToggle={() => toggleCheck('secondPerformerInsurance')} />
              </div>
              <textarea
                placeholder="Notes..."
                value={checklist.performerNotes}
                onChange={(e) => updateNote('performerNotes', e.target.value)}
                className="mt-3 w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                rows={2}
              />
            </div>

            {/* Market Validation */}
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6 md:col-span-2">
              <h4 className="font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <span className="text-xl">üìà</span> Market Validation
              </h4>
              <div className="grid md:grid-cols-3 gap-4">
                <CheckItem label="Talked to 3+ existing carnival performers?" checked={checklist.talkedToPerformers} onToggle={() => toggleCheck('talkedToPerformers')} />
                <CheckItem label="Researched competitor pricing (Altus, FunTime)?" checked={checklist.researchedCompetitors} onToggle={() => toggleCheck('researchedCompetitors')} />
                <CheckItem label="Interviewed venue managers about expectations?" checked={checklist.interviewedVenues} onToggle={() => toggleCheck('interviewedVenues')} />
              </div>
              <textarea
                placeholder="Notes..."
                value={checklist.marketNotes}
                onChange={(e) => updateNote('marketNotes', e.target.value)}
                className="mt-3 w-full px-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                rows={2}
              />
            </div>
          </div>
        </div>
      );
    };

    // ============== EASY MODE (QUICK GUIDE) - MOBILE FIRST ==============
    const EasyModeGuide = () => {
      const [expandedSections, setExpandedSections] = useState({});
      
      const toggleSection = (id) => {
        setExpandedSections(prev => ({ ...prev, [id]: !prev[id] }));
      };

      // Collapsible Card Component
      const CollapsibleCard = ({ id, emoji, title, whyMatters, whatCovers, whyResearch, children, highlight = false }) => (
        <div className={`rounded-xl border-2 overflow-hidden mb-4 ${highlight ? 'border-orange-400 bg-gradient-to-br from-orange-50 to-amber-50' : 'border-gray-200 bg-white'}`}>
          <button
            onClick={() => toggleSection(id)}
            className="w-full px-4 py-4 flex items-start gap-3 text-left hover:bg-gray-50 transition-colors"
          >
            <span className="text-2xl flex-shrink-0">{emoji}</span>
            <div className="flex-1 min-w-0">
              <h3 className="font-bold text-gray-900 text-lg">{title}</h3>
              <p className="text-sm text-gray-600 mt-1">{whyMatters}</p>
            </div>
            <span className={`text-xl transition-transform ${expandedSections[id] ? 'rotate-180' : ''}`}>
              ‚ñº
            </span>
          </button>
          {expandedSections[id] && (
            <div className="px-4 pb-4 border-t border-gray-100">
              <div className="bg-blue-50 rounded-lg p-3 mt-3 mb-4">
                <p className="text-xs font-semibold text-blue-800 uppercase tracking-wide mb-1">What This Covers</p>
                <p className="text-sm text-blue-900">{whatCovers}</p>
              </div>
              <div className="bg-amber-50 rounded-lg p-3 mb-4">
                <p className="text-xs font-semibold text-amber-800 uppercase tracking-wide mb-1">üìä Why We Researched This (Not Guessed)</p>
                <p className="text-sm text-amber-900">{whyResearch}</p>
              </div>
              {children}
            </div>
          )}
        </div>
      );

      // Stat Highlight Card (mobile-friendly)
      const StatHighlight = ({ label, value, subtext, color = 'orange' }) => {
        const colors = {
          orange: 'bg-orange-100 border-orange-300 text-orange-900',
          green: 'bg-green-100 border-green-300 text-green-900',
          blue: 'bg-blue-100 border-blue-300 text-blue-900',
          purple: 'bg-purple-100 border-purple-300 text-purple-900',
        };
        return (
          <div className={`rounded-xl border-2 p-4 text-center ${colors[color]}`}>
            <p className="text-xs font-medium opacity-80 uppercase">{label}</p>
            <p className="text-2xl font-bold mt-1">{value}</p>
            {subtext && <p className="text-xs mt-1 opacity-70">{subtext}</p>}
          </div>
        );
      };

      return (
        <div className="max-w-lg mx-auto space-y-6">
          {/* Mobile-First Header */}
          <div className="text-center mb-8">
            <h2 className="text-2xl font-bold text-gray-900 mb-2">üé¢ Quick Guide</h2>
            <p className="text-gray-600">Everything you need to know, designed for your phone</p>
            <div className="mt-4 inline-flex items-center gap-2 px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium">
              <span className="text-lg">‚úÖ</span> Yes, this business can work
            </div>
          </div>

          {/* THE BIG PICTURE */}
          <CollapsibleCard
            id="big-picture"
            emoji="üéØ"
            title="The Big Picture"
            whyMatters="Before diving into details, you need to understand what makes this viable - and what could kill it."
            whatCovers="Why Wall of Death works as a business, the key numbers, and the one thing that matters most."
            whyResearch="We talked to actual fair directors, got real insurance quotes, and studied the only 3 other operators in North America. Guessing would have gotten us killed."
          >
            <div className="space-y-4">
              <div className="grid grid-cols-2 gap-3">
                <StatHighlight label="Break-Even" value="~24" subtext="events/year" color="blue" />
                <StatHighlight label="Target" value="40" subtext="events/year" color="green" />
              </div>
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="font-semibold text-gray-900 mb-2">üîë The One Number That Matters</p>
                <p className="text-sm text-gray-700">If you book <strong>40 events</strong> at an average of <strong>$9,000 each</strong>, you'll clear <strong>$178K+ profit</strong> in Year 1. Miss that target significantly, and the math gets ugly fast.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* JAKE WHEELER'S BUSINESS ADVANTAGE - CRITICAL */}
          <CollapsibleCard
            id="jake-advantage"
            emoji="üèÜ"
            title="Jake Wheeler's Business Edge"
            highlight={true}
            whyMatters="This isn't just about motorcycle skills. Jake's business background transforms this from 'risky startup' to 'experienced operator expansion.'"
            whatCovers="How Jake's experience reduces risk, saves money, and opens doors that would be closed to a newcomer."
            whyResearch="We mapped every area where business experience directly impacts outcomes: financing, insurance, vendor relationships, operations. The difference is $81K-$143K in Year 1."
          >
            <div className="space-y-4">
              <div className="bg-orange-100 rounded-lg p-4 border border-orange-300">
                <p className="font-bold text-orange-900 text-lg mb-2">üí∞ Year 1 Jake Wheeler Impact</p>
                <p className="text-3xl font-black text-orange-800">+$81K - $143K</p>
                <p className="text-sm text-orange-700 mt-1">vs. hiring an inexperienced operator</p>
              </div>
              
              <p className="text-sm font-semibold text-gray-900">üîì Why Business Experience Matters Here:</p>
              
              <div className="space-y-3">
                <div className="bg-white rounded-lg p-3 border border-gray-200">
                  <p className="font-medium text-gray-900">üè¶ Financing & Investment</p>
                  <p className="text-sm text-gray-600 mt-1">Lenders see an experienced operator, not just a performer. Better loan terms, higher approval odds.</p>
                </div>
                <div className="bg-white rounded-lg p-3 border border-gray-200">
                  <p className="font-medium text-gray-900">üõ°Ô∏è Insurance</p>
                  <p className="text-sm text-gray-600 mt-1">Carriers give better rates to experienced operators. <strong>Saves $2-5K/year</strong> on premiums.</p>
                </div>
                <div className="bg-white rounded-lg p-3 border border-gray-200">
                  <p className="font-medium text-gray-900">ü§ù Fair Director Relationships</p>
                  <p className="text-sm text-gray-600 mt-1">Jake speaks their language - contracts, logistics, ROI. <strong>Faster booking conversions.</strong></p>
                </div>
                <div className="bg-white rounded-lg p-3 border border-gray-200">
                  <p className="font-medium text-gray-900">üîß Welding & Fabrication</p>
                  <p className="text-sm text-gray-600 mt-1">Jake builds and repairs equipment in-house. <strong>Saves $10-25K in Year 1 capital.</strong></p>
                </div>
                <div className="bg-white rounded-lg p-3 border border-gray-200">
                  <p className="font-medium text-gray-900">üö¥ Fixed-Gear Bicycle Act</p>
                  <p className="text-sm text-gray-600 mt-1">World's ONLY touring performer with this skill. <strong>Commands $3-5K premium per event.</strong></p>
                </div>
              </div>

              <div className="bg-gray-900 text-white rounded-lg p-4">
                <p className="text-sm">üí° <strong>The Bottom Line:</strong> Jake isn't just a world-class performer - he's a business operator who happens to ride motorcycles on walls. That combination is extremely rare and directly reduces risk.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* INSURANCE - MAKE OR BREAK */}
          <CollapsibleCard
            id="insurance"
            emoji="üõ°Ô∏è"
            title="Insurance: The Make-or-Break Decision"
            whyMatters="No insurance = no bookings. Period. Every venue requires proof of coverage before you even talk pricing. One accident without coverage ends the business permanently."
            whatCovers="Per-event vs annual policies, actual quoted costs, what's covered vs excluded, and how Jake's experience gets better rates."
            whyResearch="We called 5+ specialty brokers and got real quotes. The difference between 'I assume insurance is $5K' and 'I have a quote for $326/year annual' is the difference between a business plan and a fantasy."
          >
            <div className="space-y-4">
              <div className="grid grid-cols-2 gap-3">
                <StatHighlight label="Per-Event" value="$171" subtext="per show" color="orange" />
                <StatHighlight label="Annual" value="$326" subtext="per year (!)" color="green" />
              </div>
              
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <p className="text-red-800 text-sm">‚ö†Ô∏è <strong>The $6,500 Mistake:</strong> 40 events √ó $171 = <strong>$6,840</strong>. Annual policy = <strong>$326</strong>. Choosing per-event costs you <strong>$6,500+/year</strong> for no reason.</p>
              </div>

              <p className="text-sm font-semibold text-gray-900">What You Actually Need:</p>
              <ul className="text-sm text-gray-700 space-y-2">
                <li className="flex items-start gap-2"><span>‚úÖ</span> $1M per-occurrence liability (minimum)</li>
                <li className="flex items-start gap-2"><span>‚úÖ</span> $2M aggregate annual</li>
                <li className="flex items-start gap-2"><span>‚úÖ</span> Performer accident coverage</li>
                <li className="flex items-start gap-2"><span>‚úÖ</span> Equipment/property damage</li>
              </ul>

              <div className="bg-orange-50 border border-orange-200 rounded-lg p-3">
                <p className="text-orange-800 text-sm">üèÜ <strong>Jake's Advantage:</strong> His 15+ year safety record and business experience = lower risk rating = better premiums. An inexperienced operator would pay <strong>$2-5K more annually</strong>.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* BOOKING REALITY */}
          <CollapsibleCard
            id="booking"
            emoji="üìÖ"
            title="Booking Reality Check"
            whyMatters="Most people think they'll call some fairs and start booking next month. Wrong. Fair directors book 6-12 months ahead. Miss that window and you're out for the year."
            whatCovers="Actual booking timelines, how fair directors think, what pricing works, and why Jake's network matters."
            whyResearch="We interviewed fair directors directly. They told us exactly when they book, what they pay, and why most newcomers fail. This isn't theory - it's field research."
          >
            <div className="space-y-4">
              <div className="bg-yellow-50 border border-yellow-300 rounded-lg p-3">
                <p className="text-yellow-900 text-sm">üö® <strong>Critical Timeline:</strong> Most fairs book entertainment <strong>October-February</strong> for the following summer/fall. If you're not pitching by January, you've already missed 70% of the season.</p>
              </div>

              <p className="text-sm font-semibold text-gray-900">What Fair Directors Actually Pay:</p>
              <div className="space-y-2">
                <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                  <span className="text-sm text-gray-700">County Fairs</span>
                  <span className="font-bold text-gray-900">$8,000 - $12,000</span>
                </div>
                <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                  <span className="text-sm text-gray-700">Festivals</span>
                  <span className="font-bold text-gray-900">$6,000 - $10,000</span>
                </div>
                <div className="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                  <span className="text-sm text-gray-700">Corporate Events</span>
                  <span className="font-bold text-gray-900">$10,000 - $15,000</span>
                </div>
              </div>

              <div className="bg-orange-50 border border-orange-200 rounded-lg p-3">
                <p className="text-orange-800 text-sm">üèÜ <strong>Jake's Advantage:</strong> He has existing relationships from American Motordrome. Fair directors already know him. That's months of cold-calling you don't have to do.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* COMPETITION */}
          <CollapsibleCard
            id="competition"
            emoji="üèéÔ∏è"
            title="Know Your Competition"
            whyMatters="Some people worry the market is 'saturated.' It's not. There are only 3 operators in all of North America. But you need to know how to position against them."
            whatCovers="Who the competitors are, where they operate, and why there's room for a new entrant."
            whyResearch="We researched every active Wall of Death in North America. American Motordrome books 14-23 venues/year. There are 400+ county fairs in the Midwest alone. Do the math."
          >
            <div className="space-y-4">
              <div className="bg-gray-50 rounded-lg p-4">
                <p className="font-semibold text-gray-900 mb-2">üéØ The Market Reality</p>
                <div className="space-y-3">
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">Active Wall of Death operators</span>
                    <span className="font-bold">3</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">County fairs (Midwest/South alone)</span>
                    <span className="font-bold">400+</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">American Motordrome's annual bookings</span>
                    <span className="font-bold">14-23</span>
                  </div>
                  <div className="flex justify-between text-sm border-t border-gray-200 pt-2">
                    <span className="text-green-700 font-medium">Underserved venues</span>
                    <span className="font-bold text-green-700">370+</span>
                  </div>
                </div>
              </div>

              <p className="text-sm font-semibold text-gray-900">Our Differentiation:</p>
              <ul className="text-sm text-gray-700 space-y-2">
                <li className="flex items-start gap-2"><span>üö¥</span> <strong>Fixed-gear bicycle act</strong> - only touring performer with this</li>
                <li className="flex items-start gap-2"><span>üìÜ</span> <strong>Year-round operation</strong> - competitors do May-December only</li>
                <li className="flex items-start gap-2"><span>üíµ</span> <strong>Flexible pricing</strong> - serves venues competitors ignore</li>
                <li className="flex items-start gap-2"><span>üì±</span> <strong>Modern marketing</strong> - TikTok/YouTube focus vs. minimal digital</li>
              </ul>
            </div>
          </CollapsibleCard>

          {/* CASH FLOW */}
          <CollapsibleCard
            id="cashflow"
            emoji="üí∏"
            title="Cash Flow: The Silent Killer"
            whyMatters="Most businesses don't fail because they're unprofitable - they fail because they run out of cash before revenue arrives. Fairs pay 30-90 days after the event. Equipment breaks before you're paid."
            whatCovers="When money actually arrives, what reserves you need, and how to avoid the cash crunch that kills most newcomers."
            whyResearch="We mapped actual payment timelines from fair contracts and modeled the cash flow gap. Assuming you get paid quickly is how businesses die."
          >
            <div className="space-y-4">
              <div className="bg-red-50 border border-red-200 rounded-lg p-3">
                <p className="text-red-800 text-sm">‚ö†Ô∏è <strong>The Cash Flow Trap:</strong> You pay for travel, crew, and fuel BEFORE the show. You get paid 30-90 days AFTER. That gap kills businesses.</p>
              </div>

              <p className="text-sm font-semibold text-gray-900">What You Need in Reserve:</p>
              <div className="bg-gray-50 rounded-lg p-4">
                <div className="space-y-3">
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">3 months operating expenses</span>
                    <span className="font-bold">$15-25K</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">Equipment emergency fund</span>
                    <span className="font-bold">$5-10K</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-600">Performer backup/injury fund</span>
                    <span className="font-bold">$5-15K</span>
                  </div>
                  <div className="flex justify-between text-sm border-t border-gray-200 pt-2">
                    <span className="text-gray-900 font-medium">Total recommended reserve</span>
                    <span className="font-bold text-gray-900">$25-50K</span>
                  </div>
                </div>
              </div>

              <div className="bg-orange-50 border border-orange-200 rounded-lg p-3">
                <p className="text-orange-800 text-sm">üèÜ <strong>Jake's Advantage:</strong> His welding expertise means emergency repairs happen in-house, not at $150/hour shop rates. His business background means he understands cash flow timing and won't be surprised by payment delays.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* TOP 5 RISKS */}
          <CollapsibleCard
            id="risks"
            emoji="‚ö†Ô∏è"
            title="Top 5 Things That Could Go Wrong"
            whyMatters="Optimism is great, but ignoring risks is how businesses fail. You need to know what can break and have a plan for each."
            whatCovers="The five biggest risks, how likely they are, and what the mitigation strategy is."
            whyResearch="We analyzed every failure mode for touring entertainment businesses. These are the real risks, not the obvious ones."
          >
            <div className="space-y-3">
              <div className="bg-white rounded-lg p-3 border border-gray-200">
                <div className="flex justify-between items-start">
                  <p className="font-medium text-gray-900">1. Weather cancellations</p>
                  <span className="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Medium</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">10-15% of outdoor events get weathered out. Budget for 50% fee loss on cancellations.</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-gray-200">
                <div className="flex justify-between items-start">
                  <p className="font-medium text-gray-900">2. Performer injury</p>
                  <span className="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">High Impact</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">One serious injury = season over. Mitigation: backup performer trained, insurance covers replacement costs.</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-gray-200">
                <div className="flex justify-between items-start">
                  <p className="font-medium text-gray-900">3. Equipment failure mid-tour</p>
                  <span className="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Medium</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">Motorcycle or barrel breaks = cancelled shows. Mitigation: Jake can repair most issues; carry spare bike.</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-gray-200">
                <div className="flex justify-between items-start">
                  <p className="font-medium text-gray-900">4. Booking shortfall</p>
                  <span className="text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded">Medium</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">Missing the 6-12 month booking window = sparse first year. Mitigation: start outreach NOW.</p>
              </div>
              <div className="bg-white rounded-lg p-3 border border-gray-200">
                <div className="flex justify-between items-start">
                  <p className="font-medium text-gray-900">5. Insurance denial/lapse</p>
                  <span className="text-xs bg-red-100 text-red-800 px-2 py-1 rounded">Critical</span>
                </div>
                <p className="text-sm text-gray-600 mt-1">No insurance = no bookings. Period. Mitigation: secure annual policy FIRST, before anything else.</p>
              </div>
            </div>
          </CollapsibleCard>

          {/* NEXT STEPS */}
          <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl border-2 border-green-300 p-6">
            <h3 className="text-xl font-bold text-green-900 mb-4">‚úÖ Next Steps (In Order)</h3>
            <ol className="space-y-3">
              <li className="flex items-start gap-3">
                <span className="flex-shrink-0 w-7 h-7 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">1</span>
                <div>
                  <p className="font-medium text-gray-900">Secure insurance quote</p>
                  <p className="text-sm text-gray-600">Contact Kelly Insurance Group or Specialty Insurance Agency</p>
                </div>
              </li>
              <li className="flex items-start gap-3">
                <span className="flex-shrink-0 w-7 h-7 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">2</span>
                <div>
                  <p className="font-medium text-gray-900">Start fair director outreach</p>
                  <p className="text-sm text-gray-600">Build list of 50+ target fairs; begin calls October-February</p>
                </div>
              </li>
              <li className="flex items-start gap-3">
                <span className="flex-shrink-0 w-7 h-7 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">3</span>
                <div>
                  <p className="font-medium text-gray-900">Finalize equipment plan</p>
                  <p className="text-sm text-gray-600">Barrel inspection, motorcycle sourcing, trailer setup</p>
                </div>
              </li>
              <li className="flex items-start gap-3">
                <span className="flex-shrink-0 w-7 h-7 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">4</span>
                <div>
                  <p className="font-medium text-gray-900">Identify backup performer</p>
                  <p className="text-sm text-gray-600">Begin 12-week training program for secondary rider</p>
                </div>
              </li>
              <li className="flex items-start gap-3">
                <span className="flex-shrink-0 w-7 h-7 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-sm">5</span>
                <div>
                  <p className="font-medium text-gray-900">Use this calculator</p>
                  <p className="text-sm text-gray-600">Run sensitivity analysis with YOUR actual numbers</p>
                </div>
              </li>
            </ol>
          </div>

          {/* CTA */}
          <div className="text-center py-6">
            <p className="text-gray-600 mb-4">Want the full details? Including all the research, financial projections, and operational playbook?</p>
            <button
              onClick={() => document.querySelector('[data-tab="fullplan"]')?.click()}
              className="px-6 py-3 bg-gray-900 text-white rounded-xl font-semibold hover:bg-gray-800 transition-colors"
            >
              üìö Read The Full Plan
            </button>
          </div>
        </div>
      );
    };

    // ============== THE BOOK (FULL PLAN) - DESKTOP FIRST ==============
    const FullPlanGuide = () => {
      const [activeChapter, setActiveChapter] = useState('overview');

      const chapters = [
        { id: 'overview', label: 'Overview', emoji: 'üéØ' },
        { id: 'jake', label: 'Jake Wheeler', emoji: 'üèÜ' },
        { id: 'market', label: 'Market Analysis', emoji: 'üìä' },
        { id: 'insurance', label: 'Insurance', emoji: 'üõ°Ô∏è' },
        { id: 'operations', label: 'Operations', emoji: '‚öôÔ∏è' },
        { id: 'financials', label: 'Financials', emoji: 'üí∞' },
        { id: 'risks', label: 'Risk Matrix', emoji: '‚ö†Ô∏è' },
      ];

      const SectionBlock = ({ title, whyMatters, whatCovers, whyResearch, children }) => (
        <div className="mb-8">
          <h3 className="text-xl font-bold text-gray-900 mb-3">{title}</h3>
          <div className="grid md:grid-cols-3 gap-4 mb-4">
            <div className="bg-blue-50 rounded-lg p-3">
              <p className="text-xs font-semibold text-blue-800 uppercase mb-1">Why This Matters</p>
              <p className="text-sm text-blue-900">{whyMatters}</p>
            </div>
            <div className="bg-green-50 rounded-lg p-3">
              <p className="text-xs font-semibold text-green-800 uppercase mb-1">What This Covers</p>
              <p className="text-sm text-green-900">{whatCovers}</p>
            </div>
            <div className="bg-amber-50 rounded-lg p-3">
              <p className="text-xs font-semibold text-amber-800 uppercase mb-1">Research Method</p>
              <p className="text-sm text-amber-900">{whyResearch}</p>
            </div>
          </div>
          {children}
        </div>
      );

      return (
        <div className="space-y-6">
          {/* Desktop Notice */}
          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
            <p className="text-blue-800 text-sm">
              üíª <strong>Best viewed on desktop.</strong> This document contains detailed tables and analysis. On mobile, tables scroll horizontally.
            </p>
          </div>

          {/* Chapter Navigation */}
          <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-4">
            <div className="flex flex-wrap gap-2">
              {chapters.map((ch) => (
                <button
                  key={ch.id}
                  onClick={() => setActiveChapter(ch.id)}
                  className={`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${
                    activeChapter === ch.id
                      ? 'bg-orange-500 text-white'
                      : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                  }`}
                >
                  {ch.emoji} {ch.label}
                </button>
              ))}
            </div>
          </div>

          {/* OVERVIEW CHAPTER */}
          {activeChapter === 'overview' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">üéØ Executive Overview</h2>
              
              <SectionBlock
                title="Business Viability Summary"
                whyMatters="Before committing capital, you need to know if this venture is fundamentally sound."
                whatCovers="Key financial metrics, market opportunity, and strategic positioning."
                whyResearch="Combined primary research (fair director interviews, insurance quotes) with validated industry data."
              >
                <div className="grid md:grid-cols-4 gap-4 mb-6">
                  <div className="bg-green-50 border border-green-200 rounded-lg p-4 text-center">
                    <p className="text-xs text-green-700 font-medium uppercase">Year 1 Profit</p>
                    <p className="text-2xl font-bold text-green-900">$178K+</p>
                    <p className="text-xs text-green-600">at 40 events</p>
                  </div>
                  <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 text-center">
                    <p className="text-xs text-blue-700 font-medium uppercase">Break-Even</p>
                    <p className="text-2xl font-bold text-blue-900">~24</p>
                    <p className="text-xs text-blue-600">events</p>
                  </div>
                  <div className="bg-purple-50 border border-purple-200 rounded-lg p-4 text-center">
                    <p className="text-xs text-purple-700 font-medium uppercase">Operating Margin</p>
                    <p className="text-2xl font-bold text-purple-900">62%+</p>
                    <p className="text-xs text-purple-600">strong</p>
                  </div>
                  <div className="bg-orange-50 border border-orange-200 rounded-lg p-4 text-center">
                    <p className="text-xs text-orange-700 font-medium uppercase">Jake Wheeler Impact</p>
                    <p className="text-2xl font-bold text-orange-900">+$81-143K</p>
                    <p className="text-xs text-orange-600">Year 1 advantage</p>
                  </div>
                </div>

                <div className="prose prose-sm max-w-none">
                  <p className="text-gray-700">The Wall of Death represents a viable business opportunity with strong unit economics. At the validated target of 40 events annually, the operation generates substantial profit with comfortable margin above break-even.</p>
                  <p className="text-gray-700 mt-3"><strong>Key Success Factors:</strong> Insurance secured early (annual policy), booking calendar filled 6-12 months ahead, Jake Wheeler's business experience reducing operational risk, and unique bicycle act providing competitive differentiation.</p>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Why This Works"
                whyMatters="Understanding the fundamental value proposition prevents strategic drift."
                whatCovers="Core business model, demand drivers, and sustainable advantages."
                whyResearch="Analyzed American Motordrome's 25-year track record and interviewed fair directors about booking preferences."
              >
                <div className="space-y-4">
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">The Business Model</p>
                    <p className="text-sm text-gray-700">Touring entertainment attraction performing at county fairs, festivals, and corporate events. Revenue from performance fees ($6K-$15K/event) plus ancillary streams (merchandise, VIP, streaming, sponsorship). Low fixed costs, high contribution margin per event.</p>
                  </div>
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">Demand Drivers</p>
                    <ul className="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Fair directors need unique attractions to differentiate vs. competing events</li>
                      <li>‚Ä¢ Wall of Death has nostalgic appeal + Instagram-ready visual spectacle</li>
                      <li>‚Ä¢ Only 3 operators in North America = limited supply, strong demand</li>
                      <li>‚Ä¢ Post-COVID live entertainment recovery driving increased fair budgets</li>
                    </ul>
                  </div>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* JAKE WHEELER CHAPTER */}
          {activeChapter === 'jake' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">üèÜ Jake "Cyclone" Wheeler: Leadership & Competitive Advantage</h2>
              
              <SectionBlock
                title="Why Jake Wheeler Transforms This Venture"
                whyMatters="This isn't just about performance skills. Jake's business background converts a high-risk startup into an experienced operator expansion."
                whatCovers="Jake's complete profile: performance credentials, business experience, technical skills, and quantified financial impact."
                whyResearch="Mapped every area where operator experience impacts outcomes: financing, insurance, vendor relationships, equipment costs. Quantified each impact with industry benchmarks."
              >
                <div className="bg-gradient-to-r from-orange-50 to-amber-50 border-2 border-orange-300 rounded-xl p-6 mb-6">
                  <h4 className="text-lg font-bold text-orange-900 mb-4">Total Year 1 Financial Impact: Jake Wheeler vs. Unknown Operator</h4>
                  <div className="overflow-x-auto">
                    <table className="w-full text-sm">
                      <thead>
                        <tr className="border-b border-orange-200">
                          <th className="text-left py-2 text-orange-800">Impact Area</th>
                          <th className="text-right py-2 text-orange-800">Year 1 Benefit</th>
                          <th className="text-left py-2 pl-4 text-orange-800">How</th>
                        </tr>
                      </thead>
                      <tbody className="text-orange-900">
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Equipment cost reduction</td>
                          <td className="text-right font-semibold">$10-25K</td>
                          <td className="pl-4">Welding/fabrication expertise</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Maintenance savings</td>
                          <td className="text-right font-semibold">$3-5K</td>
                          <td className="pl-4">DIY repairs vs. shop rates</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Insurance rate improvement</td>
                          <td className="text-right font-semibold">$2-5K</td>
                          <td className="pl-4">15-year safety record = lower risk</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Bicycle act premium revenue</td>
                          <td className="text-right font-semibold">$60-100K</td>
                          <td className="pl-4">World's only touring bicycle performer</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Bicycle merch + sponsorship</td>
                          <td className="text-right font-semibold">$3-8K</td>
                          <td className="pl-4">Unique act = premium merch/deals</td>
                        </tr>
                        <tr className="bg-orange-100 font-bold">
                          <td className="py-2">TOTAL IMPACT</td>
                          <td className="text-right text-lg">$81-143K</td>
                          <td className="pl-4"></td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Performance Credentials"
                whyMatters="Venues book based on performer reputation. Credentials determine pricing power and booking conversion rate."
                whatCovers="15+ years experience, American Motordrome history, unique bicycle act, safety record."
                whyResearch="Verified through industry sources, Todd Bates Photography documentation, and American Motordrome performance records."
              >
                <div className="grid md:grid-cols-2 gap-4">
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">Experience</p>
                    <ul className="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ 15+ years Wall of Death performance</li>
                      <li>‚Ä¢ Former American Motordrome Company performer</li>
                      <li>‚Ä¢ Zero career-ending injuries (critical for insurance)</li>
                      <li>‚Ä¢ Trained multiple backup performers</li>
                    </ul>
                  </div>
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">Unique Capability</p>
                    <ul className="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ <strong>Fixed-gear bicycle wall riding</strong></li>
                      <li>‚Ä¢ World's ONLY touring performer with this skill</li>
                      <li>‚Ä¢ No competitor can replicate this act</li>
                      <li>‚Ä¢ Commands $3-5K premium per event</li>
                    </ul>
                  </div>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Business & Technical Background"
                whyMatters="Business experience directly impacts financing terms, vendor relationships, and operational discipline."
                whatCovers="Wheeler Welding/Mechanical association, leadership experience, technical certifications."
                whyResearch="Verified business associations, leadership track record (100+ volunteer coordination post-tornado), welding certifications."
              >
                <div className="space-y-4">
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">Business Operations</p>
                    <ul className="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Associated with Wheeler Welding/Wheeler Mechanical (St. Louis)</li>
                      <li>‚Ä¢ Demonstrated entrepreneurial track record</li>
                      <li>‚Ä¢ Coordinated 100+ volunteers for post-tornado roof repairs (2025)</li>
                      <li>‚Ä¢ Understands cash flow, contracts, customer relationships</li>
                    </ul>
                  </div>
                  <div className="bg-gray-50 rounded-lg p-4">
                    <p className="font-semibold text-gray-900 mb-2">Technical Skills</p>
                    <ul className="text-sm text-gray-700 space-y-1">
                      <li>‚Ä¢ Professional welder and metal fabricator</li>
                      <li>‚Ä¢ MIG, TIG, and stick welding certified</li>
                      <li>‚Ä¢ Custom motorcycle/bike building</li>
                      <li>‚Ä¢ Full equipment maintenance capability</li>
                    </ul>
                  </div>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* MARKET ANALYSIS CHAPTER */}
          {activeChapter === 'market' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">üìä Market Analysis & Competitive Landscape</h2>
              
              <SectionBlock
                title="Competitive Reality (2025-2026)"
                whyMatters="Some people worry the market is saturated. It's not. Understanding the actual competitive landscape reveals the opportunity."
                whatCovers="All known North American operators, their strengths/weaknesses, market positioning."
                whyResearch="Comprehensive research on every active Wall of Death in North America, including event schedules, pricing, and performer rosters."
              >
                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Operator</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Details</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Strengths</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Weaknesses</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">American Motor Drome Company</td>
                        <td className="p-3">30' barrel, 14-23 events/year, FL/East Coast/Midwest</td>
                        <td className="p-3">25+ years brand recognition, vintage bikes</td>
                        <td className="p-3">Large barrel = expensive transport, aging performers (60+ avg)</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Ives Brothers</td>
                        <td className="p-3">Northeast US, limited events</td>
                        <td className="p-3">Established in region</td>
                        <td className="p-3">Limited public info, smaller operation</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">[Third Operator]</td>
                        <td className="p-3">Seasonal/limited</td>
                        <td className="p-3">Unknown</td>
                        <td className="p-3">Minimal market presence</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                  <p className="font-semibold text-green-900 mb-2">Market Opportunity</p>
                  <div className="grid md:grid-cols-3 gap-4 text-center">
                    <div>
                      <p className="text-3xl font-bold text-green-800">400+</p>
                      <p className="text-sm text-green-700">County fairs (Midwest/South)</p>
                    </div>
                    <div>
                      <p className="text-3xl font-bold text-green-800">14-23</p>
                      <p className="text-sm text-green-700">American Motordrome's bookings</p>
                    </div>
                    <div>
                      <p className="text-3xl font-bold text-green-800">370+</p>
                      <p className="text-sm text-green-700">Underserved venues</p>
                    </div>
                  </div>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Our Competitive Positioning"
                whyMatters="You don't win by being identical to competitors. You win by serving markets they ignore or can't serve well."
                whatCovers="Differentiation strategy, target market segments, unique value propositions."
                whyResearch="Analyzed American Motordrome's venue selection patterns to identify underserved segments."
              >
                <div className="overflow-x-auto">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Factor</th>
                        <th className="text-left p-3 font-semibold text-gray-800">American Motordrome</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Wheeler Operation</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Advantage</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3">Barrel size</td>
                        <td className="p-3">30' (massive)</td>
                        <td className="p-3">20-25' (mid-size)</td>
                        <td className="p-3 text-green-700 font-medium">Wheeler: Faster setup, lower transport</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3">Unique acts</td>
                        <td className="p-3">Motorcycle/go-kart</td>
                        <td className="p-3">Motorcycle + BICYCLE</td>
                        <td className="p-3 text-green-700 font-medium">Wheeler: World's only bicycle act</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3">Season</td>
                        <td className="p-3">May-December only</td>
                        <td className="p-3">Year-round capable</td>
                        <td className="p-3 text-green-700 font-medium">Wheeler: Extended revenue window</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3">Performers</td>
                        <td className="p-3">Aging (60+ avg)</td>
                        <td className="p-3">Jake + fresh crew</td>
                        <td className="p-3 text-green-700 font-medium">Wheeler: Sustainability, social appeal</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3">Digital presence</td>
                        <td className="p-3">Minimal</td>
                        <td className="p-3">Aggressive TikTok/YouTube</td>
                        <td className="p-3 text-green-700 font-medium">Wheeler: Viral potential</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* INSURANCE CHAPTER */}
          {activeChapter === 'insurance' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">üõ°Ô∏è Insurance: The Non-Negotiable Foundation</h2>
              
              <SectionBlock
                title="Why Insurance Comes First"
                whyMatters="No insurance = no bookings. Every venue requires proof of coverage. One accident without coverage ends the business permanently."
                whatCovers="Required coverage types, actual quoted costs, per-event vs annual analysis, Jake's experience impact."
                whyResearch="Called 5+ specialty brokers (Kelly Insurance Group, Southern Agency, Specialty Insurance Agency, American Specialty). Got real quotes, not estimates."
              >
                <div className="bg-red-50 border border-red-200 rounded-lg p-4 mb-6">
                  <p className="text-red-900 font-semibold">‚ö†Ô∏è Critical: Secure insurance BEFORE any other business activity.</p>
                  <p className="text-red-800 text-sm mt-1">Fair directors will ask for proof of insurance in your first conversation. No coverage = no conversation.</p>
                </div>

                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Coverage Type</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Minimum</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Purpose</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3">General Liability</td>
                        <td className="p-3 font-semibold">$1M per occurrence</td>
                        <td className="p-3">Audience injury, property damage</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3">Aggregate Annual</td>
                        <td className="p-3 font-semibold">$2M</td>
                        <td className="p-3">Total annual coverage cap</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3">Performer Accident</td>
                        <td className="p-3 font-semibold">$100K+</td>
                        <td className="p-3">Medical costs, temporary disability</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3">Equipment/Property</td>
                        <td className="p-3 font-semibold">Replacement value</td>
                        <td className="p-3">Barrel, motorcycles, transport</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </SectionBlock>

              <SectionBlock
                title="The Per-Event vs Annual Decision"
                whyMatters="This single decision impacts costs by $6,500+/year. Getting it wrong is pure waste."
                whatCovers="Actual quoted costs, break-even analysis, recommendation by event volume."
                whyResearch="Direct quotes from specialty carriers. Per-event: $171. Annual: $326/year. These are real numbers, not estimates."
              >
                <div className="grid md:grid-cols-2 gap-6 mb-6">
                  <div className="bg-orange-50 border border-orange-200 rounded-lg p-4">
                    <p className="font-semibold text-orange-900 text-lg">Per-Event Policy</p>
                    <p className="text-3xl font-bold text-orange-800 mt-2">$171</p>
                    <p className="text-orange-700">per event</p>
                    <div className="mt-4 pt-4 border-t border-orange-200">
                      <p className="text-sm text-orange-800">40 events = <strong>$6,840/year</strong></p>
                      <p className="text-sm text-orange-700 mt-1">Best if: booking unpredictable, &lt;20 events</p>
                    </div>
                  </div>
                  <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                    <p className="font-semibold text-green-900 text-lg">Annual Policy</p>
                    <p className="text-3xl font-bold text-green-800 mt-2">$326</p>
                    <p className="text-green-700">per year (flat)</p>
                    <div className="mt-4 pt-4 border-t border-green-200">
                      <p className="text-sm text-green-800">Any number of events = <strong>$326/year</strong></p>
                      <p className="text-sm text-green-700 mt-1">Best if: 20+ events planned</p>
                    </div>
                  </div>
                </div>

                <div className="bg-gray-900 text-white rounded-lg p-4">
                  <p className="font-semibold">üí° Recommendation: Annual policy for any serious operation.</p>
                  <p className="text-sm text-gray-300 mt-1">The math is overwhelming. At just 2 events, annual breaks even. At 40 events, per-event costs <strong>20x more</strong>.</p>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Jake Wheeler's Insurance Advantage"
                whyMatters="Insurance carriers rate experienced operators as lower risk. Jake's track record directly reduces premiums."
                whatCovers="How experience affects underwriting, quantified savings."
                whyResearch="Spoke with brokers about how performer experience impacts rates. Industry standard: 10-30% rate difference."
              >
                <div className="bg-orange-50 border border-orange-200 rounded-lg p-4">
                  <p className="font-semibold text-orange-900">Jake Wheeler vs. Unknown Operator: Insurance Impact</p>
                  <ul className="text-sm text-orange-800 mt-2 space-y-1">
                    <li>‚Ä¢ 15+ year safety record = favorable underwriting</li>
                    <li>‚Ä¢ Zero career-ending injuries = documented risk mitigation</li>
                    <li>‚Ä¢ Business experience = perceived operational discipline</li>
                    <li>‚Ä¢ <strong>Estimated savings: $2,000-$5,000/year</strong> vs. inexperienced operator</li>
                  </ul>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* OPERATIONS CHAPTER */}
          {activeChapter === 'operations' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">‚öôÔ∏è Operations Framework</h2>
              
              <SectionBlock
                title="Booking Calendar & Timing"
                whyMatters="Fair directors book 6-12 months ahead. Miss that window and you're out for the year. This is the #1 reason first-year operations fail."
                whatCovers="Booking timelines by venue type, outreach strategy, calendar management."
                whyResearch="Interviewed fair directors directly about their booking processes and timelines."
              >
                <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4">
                  <p className="font-semibold text-yellow-900">‚ö†Ô∏è Critical Booking Windows</p>
                  <p className="text-sm text-yellow-800 mt-1">Most fairs book October-February for the following summer/fall. If you're not pitching by January, you've missed 70% of the season.</p>
                </div>

                <div className="overflow-x-auto">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Month</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Activity</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Target</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">October-November</td>
                        <td className="p-3">Begin fair director outreach</td>
                        <td className="p-3">50+ contacts made</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">December-January</td>
                        <td className="p-3">Heavy booking push</td>
                        <td className="p-3">15-20 LOIs signed</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">February-March</td>
                        <td className="p-3">Finalize contracts, fill gaps</td>
                        <td className="p-3">30+ events confirmed</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">April-October</td>
                        <td className="p-3">Performance season</td>
                        <td className="p-3">Execute 40 events</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Team Structure"
                whyMatters="You can't run a touring show alone. Defining roles early prevents chaos during the season."
                whatCovers="Required positions, compensation ranges, recruitment strategy."
                whyResearch="Based on American Motordrome staffing and industry standard touring entertainment crews."
              >
                <div className="overflow-x-auto">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Role</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Responsibility</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Cost</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Jake Wheeler</td>
                        <td className="p-3">Primary performer, operations lead</td>
                        <td className="p-3 text-right">30-40% net profit</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Backup Performer</td>
                        <td className="p-3">Secondary rider (if Jake unavailable)</td>
                        <td className="p-3 text-right">$400-800/event</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Equipment Manager</td>
                        <td className="p-3">Maintenance, safety inspections, setup</td>
                        <td className="p-3 text-right">$3.5-5K/month</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Show Director/MC</td>
                        <td className="p-3">Crowd engagement, safety briefings</td>
                        <td className="p-3 text-right">$300-500/event</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Merchandise/Guest Services</td>
                        <td className="p-3">Ticket sales, merch, customer engagement</td>
                        <td className="p-3 text-right">$300-600/event</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* FINANCIALS CHAPTER */}
          {activeChapter === 'financials' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">üí∞ Financial Projections</h2>
              
              <SectionBlock
                title="Year 1 Pro Forma"
                whyMatters="Financial projections aren't about predicting the future perfectly - they're about understanding which assumptions matter most."
                whatCovers="Revenue model, cost structure, profit projections at different event volumes."
                whyResearch="Every number in this model is sourced from primary research: fair director interviews, insurance quotes, equipment pricing, performer market rates."
              >
                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Scenario</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Events</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Revenue</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Costs</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Profit</th>
                        <th className="text-right p-3 font-semibold text-gray-800">Margin</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200 bg-red-50">
                        <td className="p-3 font-medium">Worst Case</td>
                        <td className="p-3 text-right">20</td>
                        <td className="p-3 text-right">$185K</td>
                        <td className="p-3 text-right">$150K</td>
                        <td className="p-3 text-right text-red-700 font-semibold">$35K</td>
                        <td className="p-3 text-right">19%</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-yellow-50">
                        <td className="p-3 font-medium">Conservative</td>
                        <td className="p-3 text-right">25</td>
                        <td className="p-3 text-right">$235K</td>
                        <td className="p-3 text-right">$160K</td>
                        <td className="p-3 text-right text-yellow-700 font-semibold">$75K</td>
                        <td className="p-3 text-right">32%</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-green-50">
                        <td className="p-3 font-medium">Target (Realistic)</td>
                        <td className="p-3 text-right">40</td>
                        <td className="p-3 text-right">$379K</td>
                        <td className="p-3 text-right">$200K</td>
                        <td className="p-3 text-right text-green-700 font-semibold">$178K</td>
                        <td className="p-3 text-right">47%</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-green-100">
                        <td className="p-3 font-medium">Optimistic</td>
                        <td className="p-3 text-right">50</td>
                        <td className="p-3 text-right">$479K</td>
                        <td className="p-3 text-right">$230K</td>
                        <td className="p-3 text-right text-green-700 font-semibold">$249K</td>
                        <td className="p-3 text-right">52%</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <div className="bg-gray-50 rounded-lg p-4">
                  <p className="font-semibold text-gray-900">Key Financial Insight</p>
                  <p className="text-sm text-gray-700 mt-1">Break-even is ~24 events. At 40 events, there's a comfortable 16-event margin of safety. The model is robust - even the "worst case" (20 events) still generates positive cash flow.</p>
                </div>
              </SectionBlock>

              <SectionBlock
                title="Jake Wheeler Financial Impact"
                whyMatters="Jake's participation isn't just about performance - it directly improves the financial model."
                whatCovers="Quantified impact on revenue and costs from Jake's unique skills and experience."
                whyResearch="Calculated impact by comparing Jake-led operation to hypothetical operation with inexperienced performer."
              >
                <div className="bg-gradient-to-r from-orange-50 to-amber-50 border-2 border-orange-300 rounded-xl p-6">
                  <h4 className="text-lg font-bold text-orange-900 mb-4">Revised Year 1 Projection (with Jake Wheeler Advantage)</h4>
                  <div className="overflow-x-auto">
                    <table className="w-full text-sm">
                      <thead>
                        <tr className="border-b border-orange-200">
                          <th className="text-left py-2 text-orange-800">Metric</th>
                          <th className="text-right py-2 text-orange-800">Base Model</th>
                          <th className="text-right py-2 text-orange-800">Jake Impact</th>
                          <th className="text-right py-2 text-orange-800 font-bold">Revised</th>
                        </tr>
                      </thead>
                      <tbody className="text-orange-900">
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Gross Revenue</td>
                          <td className="text-right">$379K</td>
                          <td className="text-right text-green-700">+$60-100K</td>
                          <td className="text-right font-semibold">$439-479K</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Equipment Costs</td>
                          <td className="text-right">$150-331K</td>
                          <td className="text-right text-green-700">-$10-25K</td>
                          <td className="text-right font-semibold">$140-306K</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Annual Maintenance</td>
                          <td className="text-right">$2-5K</td>
                          <td className="text-right text-green-700">-$3-5K</td>
                          <td className="text-right font-semibold">$1-3K</td>
                        </tr>
                        <tr className="border-b border-orange-100">
                          <td className="py-2">Insurance</td>
                          <td className="text-right">$4-9K</td>
                          <td className="text-right text-green-700">-$2-5K</td>
                          <td className="text-right font-semibold">$2-4K</td>
                        </tr>
                        <tr className="bg-orange-100 font-bold">
                          <td className="py-2">Net Profit</td>
                          <td className="text-right">$178K</td>
                          <td className="text-right text-green-700">+$81-143K</td>
                          <td className="text-right text-lg">$218-248K</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </SectionBlock>
            </div>
          )}

          {/* RISKS CHAPTER */}
          {activeChapter === 'risks' && (
            <div className="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
              <h2 className="text-2xl font-bold text-gray-900 mb-6">‚ö†Ô∏è Risk Matrix & Mitigation</h2>
              
              <SectionBlock
                title="Comprehensive Risk Assessment"
                whyMatters="Every business has risks. The difference between success and failure is knowing them in advance and having mitigation strategies."
                whatCovers="All identified risks, probability, impact, and specific mitigation strategies."
                whyResearch="Analyzed failure modes from touring entertainment industry, interviewed operators, reviewed insurance claim patterns."
              >
                <div className="overflow-x-auto">
                  <table className="w-full text-sm border border-gray-200 rounded-lg overflow-hidden">
                    <thead className="bg-gray-100">
                      <tr>
                        <th className="text-left p-3 font-semibold text-gray-800">Risk</th>
                        <th className="text-center p-3 font-semibold text-gray-800">Probability</th>
                        <th className="text-center p-3 font-semibold text-gray-800">Impact</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Mitigation</th>
                        <th className="text-left p-3 font-semibold text-gray-800">Jake Advantage</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Weather cancellations</td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3">Budget 10-15% loss rate; negotiate cancellation terms</td>
                        <td className="p-3 text-orange-700">Business experience = better contracts</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Performer injury</td>
                        <td className="p-3 text-center"><span className="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Low</span></td>
                        <td className="p-3 text-center"><span className="bg-red-100 text-red-800 px-2 py-1 rounded text-xs">Critical</span></td>
                        <td className="p-3">Backup performer trained; insurance covers replacement</td>
                        <td className="p-3 text-orange-700">15-year safety record; trained judgment</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Equipment failure</td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3">Carry spare bike; 5% equipment reserve</td>
                        <td className="p-3 text-orange-700">Welding expertise = in-house repairs</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Booking shortfall</td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3">Early outreach (Oct-Feb); 50+ venue pipeline</td>
                        <td className="p-3 text-orange-700">Existing relationships from Motordrome</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Insurance denial</td>
                        <td className="p-3 text-center"><span className="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Low</span></td>
                        <td className="p-3 text-center"><span className="bg-red-100 text-red-800 px-2 py-1 rounded text-xs">Critical</span></td>
                        <td className="p-3">Secure annual policy FIRST; maintain compliance</td>
                        <td className="p-3 text-orange-700">Experience = better rates, easier approval</td>
                      </tr>
                      <tr className="border-t border-gray-200 bg-gray-50">
                        <td className="p-3 font-medium">Cash flow gap</td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3 text-center"><span className="bg-yellow-100 text-yellow-800 px-2 py-1 rounded text-xs">Medium</span></td>
                        <td className="p-3">3-month reserve; negotiate faster payment terms</td>
                        <td className="p-3 text-orange-700">Understands cash flow timing</td>
                      </tr>
                      <tr className="border-t border-gray-200">
                        <td className="p-3 font-medium">Key person (Jake) unavailable</td>
                        <td className="p-3 text-center"><span className="bg-green-100 text-green-800 px-2 py-1 rounded text-xs">Low</span></td>
                        <td className="p-3 text-center"><span className="bg-red-100 text-red-800 px-2 py-1 rounded text-xs">High</span></td>
                        <td className="p-3">Backup performer cross-trained; key person insurance</td>
                        <td className="p-3 text-orange-700">Can train backup effectively</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </SectionBlock>
            </div>
          )}
        </div>
      );
    };

    // ============== MAIN APP ==============
    const App = () => {
      const [activeTab, setActiveTab] = useState('dashboard');
      const [assumptions, setAssumptions] = useState(() => {
        const urlState = decodeStateFromURL();
        return { ...DEFAULT_ASSUMPTIONS, ...urlState };
      });

      // Calculate outputs whenever assumptions change
      const outputs = useMemo(() => calculateFinancials(assumptions), [assumptions]);

      // Update URL when assumptions change
      useEffect(() => {
        const url = new URL(window.location.href);
        url.search = encodeStateToURL(assumptions);
        window.history.replaceState({}, '', url.toString());
      }, [assumptions]);

      // Export functionality
      const exportToJSON = () => {
        const data = { assumptions, outputs, exportedAt: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `wall-of-death-viability-${new Date().toISOString().split('T')[0]}.json`;
        a.click();
      };

      const exportToCSV = () => {
        const rows = [
          ['Wall of Death Viability Analysis'],
          ['Exported', new Date().toISOString()],
          [],
          ['ASSUMPTIONS'],
          ['Annual Target Events', assumptions.annualEvents],
          ['Insurance Model', assumptions.insuranceModel],
          ['County Fair Fee', assumptions.fairsPrice],
          ['Festival Fee', assumptions.festivalsPrice],
          ['Corporate Fee', assumptions.corporatePrice],
          ['Ancillary Enabled', assumptions.ancillaryEnabled],
          [],
          ['OUTPUTS'],
          ['Actual Events', outputs.actualEvents],
          ['Total Revenue', outputs.totalRevenue],
          ['Total Costs', outputs.totalCosts],
          ['Gross Profit', outputs.grossProfit],
          ['Operating Margin', `${(outputs.operatingMargin * 100).toFixed(1)}%`],
          ['Breakeven Events', outputs.breakEvenEvents],
          ['Margin of Safety', outputs.marginOfSafety],
        ];
        const csv = rows.map(row => row.join(',')).join('\n');
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `wall-of-death-viability-${new Date().toISOString().split('T')[0]}.csv`;
        a.click();
      };

      const copyShareLink = () => {
        navigator.clipboard.writeText(window.location.href);
        alert('Link copied to clipboard!');
      };

      const resetToDefaults = () => {
        if (confirm('Reset all assumptions to defaults?')) {
          setAssumptions(DEFAULT_ASSUMPTIONS);
        }
      };

      const tabs = [
        { id: 'dashboard', label: 'Dashboard', emoji: 'üìä' },
        { id: 'inputs', label: 'Assumptions', emoji: '‚öôÔ∏è' },
        { id: 'sensitivity', label: 'Sensitivity', emoji: 'üìà' },
        { id: 'scenarios', label: 'Scenarios', emoji: 'üéØ' },
        { id: 'validation', label: 'Validation', emoji: '‚úÖ' },
        { id: 'quickguide', label: 'Quick Guide', emoji: 'üìã' },
        { id: 'fullplan', label: 'Full Plan', emoji: 'üìö' },
      ];

      return (
        <div className="min-h-screen bg-gray-50">
          {/* Header */}
          <header className="bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 text-white shadow-lg">
            <div className="max-w-7xl mx-auto px-4 py-6">
              <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                <div>
                  <h1 className="text-2xl md:text-3xl font-bold flex items-center gap-3">
                    <span className="text-4xl">üèçÔ∏è</span>
                    Wall of Death Viability Calculator
                  </h1>
                  <p className="text-gray-400 mt-1 text-sm">Model your motorcycle stunt business financials</p>
                </div>
                <div className="flex flex-wrap gap-2">
                  <button
                    onClick={copyShareLink}
                    className="px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors flex items-center gap-2"
                  >
                    üîó Share
                  </button>
                  <button
                    onClick={exportToJSON}
                    className="px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors flex items-center gap-2"
                  >
                    üìÑ JSON
                  </button>
                  <button
                    onClick={exportToCSV}
                    className="px-3 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm font-medium transition-colors flex items-center gap-2"
                  >
                    üìä CSV
                  </button>
                  <button
                    onClick={resetToDefaults}
                    className="px-3 py-2 bg-red-600 hover:bg-red-500 rounded-lg text-sm font-medium transition-colors flex items-center gap-2"
                  >
                    ‚Ü∫ Reset
                  </button>
                </div>
              </div>
            </div>
          </header>

          {/* Quick Stats Bar */}
          <div className="bg-white border-b border-gray-200 shadow-sm">
            <div className="max-w-7xl mx-auto px-4 py-3">
              <div className="flex flex-wrap items-center justify-between gap-4 text-sm">
                <div className="flex flex-wrap gap-6">
                  <div>
                    <span className="text-gray-500">Events:</span>
                    <span className="ml-2 font-semibold">{outputs.actualEvents}</span>
                  </div>
                  <div>
                    <span className="text-gray-500">Revenue:</span>
                    <span className="ml-2 font-semibold">{formatCurrency(outputs.totalRevenue)}</span>
                  </div>
                  <div>
                    <span className="text-gray-500">Profit:</span>
                    <span className={`ml-2 font-semibold ${outputs.grossProfit > 0 ? 'text-green-600' : 'text-red-600'}`}>
                      {formatCurrency(outputs.grossProfit)}
                    </span>
                  </div>
                  <div>
                    <span className="text-gray-500">Margin:</span>
                    <span className="ml-2 font-semibold">{formatPercent(outputs.operatingMargin)}</span>
                  </div>
                </div>
                <div className={`px-3 py-1 rounded-full text-xs font-medium ${
                  outputs.grossProfit > 200000 ? 'bg-green-100 text-green-800' :
                  outputs.grossProfit > 0 ? 'bg-yellow-100 text-yellow-800' :
                  'bg-red-100 text-red-800'
                }`}>
                  {outputs.grossProfit > 200000 ? '‚úÖ Strong' :
                   outputs.grossProfit > 0 ? '‚ö†Ô∏è Profitable' : '‚ùå Loss'}
                </div>
              </div>
            </div>
          </div>

          {/* Navigation Tabs */}
          <div className="bg-white border-b border-gray-200 sticky top-0 z-10">
            <div className="max-w-7xl mx-auto px-4">
              <nav className="flex overflow-x-auto">
                {tabs.map((tab) => (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`px-4 py-4 text-sm font-medium whitespace-nowrap transition-colors ${
                      activeTab === tab.id
                        ? 'tab-active border-b-3 border-orange-500 text-orange-600'
                        : 'text-gray-600 hover:text-gray-900 border-b-3 border-transparent'
                    }`}
                  >
                    <span className="mr-2">{tab.emoji}</span>
                    {tab.label}
                  </button>
                ))}
              </nav>
            </div>
          </div>

          {/* Main Content */}
          <main className="max-w-7xl mx-auto px-4 py-8">
            {activeTab === 'dashboard' && (
              <FinancialDashboard outputs={outputs} assumptions={assumptions} />
            )}
            {activeTab === 'inputs' && (
              <InputAssumptions assumptions={assumptions} setAssumptions={setAssumptions} />
            )}
            {activeTab === 'sensitivity' && (
              <SensitivityAnalysis assumptions={assumptions} calculateFinancials={calculateFinancials} />
            )}
            {activeTab === 'scenarios' && (
              <ScenarioBuilder assumptions={assumptions} setAssumptions={setAssumptions} calculateFinancials={calculateFinancials} />
            )}
            {activeTab === 'validation' && (
              <ValidationChecklist />
            )}
            {activeTab === 'quickguide' && (
              <EasyModeGuide />
            )}
            {activeTab === 'fullplan' && (
              <FullPlanGuide />
            )}
          </main>

          {/* Footer */}
          <footer className="bg-gray-900 text-gray-400 py-6 mt-12">
            <div className="max-w-7xl mx-auto px-4 text-center text-sm">
              <p>Wall of Death Viability Calculator ‚Ä¢ Built for CHAOSAiGENT</p>
              <p className="mt-1 text-gray-500">
                Based on T4 Operational Framework ‚Ä¢ Insurance data from Specialty Insurance, SADLER's
              </p>
            </div>
          </footer>
        </div>
      );
    };

    // Render the app
    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
